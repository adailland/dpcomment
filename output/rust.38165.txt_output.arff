% Generated by Discussion model rust.38165.txt
% File generated on 2017/08/02 15:59:34

@relation pr1501703974241

@attribute author String
@attribute textual String
@attribute isProjectMember {TRUE, FALSE}
@attribute isInvited {TRUE, FALSE}
@attribute numberOfWords numeric
@attribute commentsSoFar numeric
@attribute allUtterancesSoFar numeric
@attribute utterancesInCommentSoFar numeric
@attribute utteredByOriginalPoster {TRUE, FALSE}
@attribute hasCapitalizedWord {TRUE, FALSE}
@attribute containsShould {TRUE, FALSE}
@attribute hasDecisions {TRUE, FALSE}
@attribute howManyDecisions numeric
@attribute idComment numeric

@data
Yamakaky,"Fixes #37783.",FALSE,FALSE,2,0,0,0,TRUE,TRUE,FALSE,TRUE,0,1
Yamakaky,"Fix alignment of file paths for better readability",FALSE,FALSE,8,0,2,2,TRUE,TRUE,FALSE,TRUE,0,1
Yamakaky,"RUST_BACKTRACE=full prints all the informations (current behaviour)",FALSE,FALSE,7,0,3,3,TRUE,TRUE,FALSE,TRUE,0,1
Yamakaky,"RUST_BACKTRACE=(short|yes) is the default and does:",FALSE,FALSE,6,0,4,4,TRUE,TRUE,FALSE,TRUE,0,1
Yamakaky,"Skip irrelevant frames at the beginning and the endRemove function addressRemove the current directory from the absolute pathsRemove ::hfabe6541873 at the end of the symbols",FALSE,FALSE,25,0,5,5,TRUE,TRUE,FALSE,TRUE,0,1
Yamakaky,"RUST_BACKTRACE=(0|no) disables the backtrace.",FALSE,FALSE,4,0,6,6,TRUE,TRUE,FALSE,TRUE,0,1
Yamakaky,"RUST_BACKTRACE=<everything else> is equivalent to short forbackward compatibility.",FALSE,FALSE,8,0,7,7,TRUE,TRUE,FALSE,TRUE,0,1
Yamakaky,"More uniform printing across platforms.",FALSE,FALSE,5,0,9,9,TRUE,TRUE,FALSE,TRUE,0,1
Yamakaky,"Removed, TODO in a new PR:",FALSE,FALSE,6,0,10,10,TRUE,TRUE,FALSE,TRUE,0,1
Yamakaky,"Remove path prefix for libraries and libstd",FALSE,FALSE,7,0,11,11,TRUE,TRUE,FALSE,TRUE,0,1
Yamakaky,"Example of short backtrace:",FALSE,FALSE,4,0,12,12,TRUE,TRUE,FALSE,TRUE,0,1
rust-highfive,"Thanks for the pull request, and welcome! The Rust team is excited to review your changes, and you should hear from @brson (or someone else) soon.",FALSE,FALSE,26,1,15,0,FALSE,TRUE,TRUE,TRUE,0,2
rust-highfive,"If any changes to this PR are deemed necessary, please add them as extra commits. This ensures that the reviewer can see what has changed since they last reviewed the code. Due to the way GitHub handles out-of-date commits, this should also make it reasonably obvious what issues have or haven't been addressed. Large or tricky changes may require several passes of review and changes.",FALSE,FALSE,65,1,16,1,FALSE,TRUE,TRUE,TRUE,0,2
rust-highfive,"Please see the contribution instructions for more information.",FALSE,FALSE,8,1,17,2,FALSE,TRUE,FALSE,TRUE,0,2
Yamakaky,"Any idea about how I could get access to the build root path?Also, I'm thinking about using std::env::current_dir, but can I use it in the unwinding?",FALSE,FALSE,26,2,19,1,TRUE,TRUE,FALSE,TRUE,0,3
Yamakaky,"Result formatting with RUST_BACKTRACE=short:",FALSE,FALSE,4,3,20,0,TRUE,TRUE,FALSE,TRUE,0,4
Yamakaky,"and with RUST_BACKTRACE=full:",FALSE,FALSE,3,3,21,1,TRUE,TRUE,FALSE,TRUE,0,4
Yamakaky,"I plan to mask 1-8 and 12-16 with short. I think that's what you care about most of the time.",FALSE,FALSE,20,3,22,2,TRUE,TRUE,FALSE,TRUE,0,4
Mark-Simulacrum,"Those appear to be the same, did you copy the wrong thing in?",FALSE,FALSE,13,4,23,0,FALSE,FALSE,FALSE,TRUE,0,5
Yamakaky,"For now they are nearly the same, except the address which is not printed with short.An option would be to first construct a Vec<{demangled, addr, [files]}>, then print it. Is it OK to alloc in this place, though?Also, can I use std::env::current_dir in this place?",FALSE,FALSE,45,5,26,2,TRUE,TRUE,FALSE,TRUE,0,6
Yamakaky,"In fact, that may not be necessary. We can simply recognized the mangled form of std::panicking::*, rust_begin_unwind, main (14 in the stacktrace above) and _rust_maybe_catch_main to determine the range of frames to print, and use a double pass. That should catch most of the unwanted frames.",FALSE,FALSE,46,6,28,1,TRUE,TRUE,TRUE,TRUE,0,7
Yamakaky,"With panic! and without the ::h234567898765 part:",FALSE,FALSE,7,7,29,0,TRUE,FALSE,FALSE,TRUE,0,8
estebank,"I believe you should be able to accomplish item 4 in #37783 by doing something like",FALSE,FALSE,16,8,30,0,FALSE,FALSE,TRUE,TRUE,0,9
Yamakaky,"No, this loop only prints the at file:line lines.",FALSE,FALSE,9,9,31,0,TRUE,FALSE,FALSE,TRUE,0,10
Yamakaky,"It's getting better!",FALSE,FALSE,3,10,32,0,TRUE,FALSE,FALSE,TRUE,0,11
Yamakaky,"compared to",FALSE,FALSE,2,10,33,1,TRUE,FALSE,FALSE,TRUE,0,11
Yamakaky,"Added removal of path prefix. It prints ./<path> for files in the current directory, at builtin file <file> for std and such, and at library file <file> for libraries. For now, the path are hardcoded for my system. I need to get the buildroot path, and the paths from -L. Any idea?",FALSE,FALSE,52,11,34,0,TRUE,TRUE,FALSE,TRUE,0,12
Yamakaky,"Can someone test on windows?",FALSE,FALSE,5,12,35,0,TRUE,FALSE,FALSE,TRUE,0,13
Yamakaky,"Updated first post.r? @alexcrichton",FALSE,FALSE,4,13,36,0,TRUE,FALSE,FALSE,TRUE,0,14
alexcrichton,"This seems sort of suspicious, how come this was necessary?",FALSE,TRUE,10,14,38,1,FALSE,TRUE,FALSE,TRUE,0,15
Yamakaky,"See #38165 (comment)",FALSE,FALSE,3,15,39,0,TRUE,FALSE,FALSE,TRUE,0,16
alexcrichton,"These values seem to be quite subtle, could you be sure to comment as to their purpose here?",FALSE,TRUE,18,16,41,1,FALSE,TRUE,FALSE,TRUE,0,17
Yamakaky,"OK. In fact, it controls if the unwinding should use the short or long backtrace format.",FALSE,FALSE,16,17,43,1,TRUE,TRUE,TRUE,TRUE,0,18
alexcrichton,"In the interest of being as conservative as possible here, could we leave this as just recognizing 0?",FALSE,TRUE,18,18,45,1,FALSE,TRUE,FALSE,TRUE,0,19
Yamakaky,"Fixed in ddfef15.",FALSE,FALSE,3,19,46,0,TRUE,FALSE,FALSE,TRUE,0,20
alexcrichton,"Could this just be collapsed with the case below?",FALSE,TRUE,9,20,47,0,FALSE,FALSE,FALSE,TRUE,0,21
Yamakaky,"Are you sure? I find it cleaner with the  catch anything  separated.",FALSE,FALSE,12,21,48,0,TRUE,TRUE,FALSE,TRUE,0,22
alexcrichton,"Could this use option_env and handle the None case to ensure that we can build the standard library separately if need be?",FALSE,TRUE,22,22,50,1,FALSE,TRUE,FALSE,TRUE,0,23
Yamakaky,"See #38165 (comment)",FALSE,FALSE,3,23,51,0,TRUE,FALSE,FALSE,TRUE,0,24
Yamakaky,"Fixed in 7780ef8",FALSE,FALSE,3,24,52,0,TRUE,FALSE,FALSE,TRUE,0,25
alexcrichton,"Hm I'm curious where this path name came into effect?",FALSE,TRUE,10,25,53,0,FALSE,TRUE,FALSE,TRUE,0,26
Yamakaky,"It's a dummy value, because the library directory is defined at compilation of the crate, not of stdlib. I still have to find a way to get it.",FALSE,FALSE,28,26,54,0,TRUE,TRUE,FALSE,TRUE,0,27
alexcrichton,"This logic seems like we'd want to do this across all platforms, right? Perhaps this could go into the common module?",FALSE,TRUE,21,27,56,1,FALSE,TRUE,FALSE,TRUE,0,28
Yamakaky,"Sure, that would just need a bit of refactoring.",FALSE,FALSE,9,28,57,0,TRUE,FALSE,FALSE,TRUE,0,29
Yamakaky,"The CFG_BUILD_DIR stuff is a hack until I find a cleaner way to get the build dir. Any idea?I didn't test on Windows, can someone test?",FALSE,FALSE,26,29,59,1,TRUE,TRUE,FALSE,TRUE,0,30
Yamakaky,"Is it possible to also have the appveyor build? It would help me supporting windows.",FALSE,FALSE,15,30,60,0,TRUE,TRUE,FALSE,TRUE,0,31
Yamakaky,"@alexcrichton  A solution for cleaner code reuse would be that the unwinding function calls a platform-dependent function that generates some sort of Vec, then prints it. Not sure if it's an option, though, since it would allocate while unwinding.",FALSE,FALSE,40,31,62,1,TRUE,TRUE,FALSE,TRUE,0,32
Mark-Simulacrum,"The platform specific option could potentially return an iterator instead of a vec to avoid the allocation (through impl Trait, or just explicitly naming it).",FALSE,FALSE,25,32,64,1,FALSE,TRUE,FALSE,TRUE,0,33
Yamakaky,"I thought about that, but it may be complicated since the system specific code gives a callback to a C library that's invoked for each frame.",FALSE,FALSE,26,33,65,0,TRUE,TRUE,FALSE,TRUE,0,34
Yamakaky,"Sound like libunwind supports iterative unwinding unw_step, but not chosen for rust (see this comment for more background)",FALSE,FALSE,18,34,66,0,TRUE,FALSE,FALSE,TRUE,0,35
Yamakaky,"On iOS, the code uses a builtin backtrace function which sets an array of pointers.",FALSE,FALSE,15,34,67,1,TRUE,TRUE,FALSE,TRUE,0,35
Yamakaky,"Windows uses a frame iterator",FALSE,FALSE,5,34,68,2,TRUE,TRUE,FALSE,TRUE,0,35
Yamakaky,"The only trouble is gcc. We could convert it to something like the iOS code easily.",FALSE,FALSE,16,34,69,3,TRUE,TRUE,FALSE,TRUE,0,35
Yamakaky,"What I propose is to add the structs Backtrace which implements Iterator<Frame>. These two structs would be defined in a system-specific manner, with a common trait for Frame. The only public interface for Frame would be functions to get a CStr symbol name, symbol address and file names and line number. I think it should work, and with only static dispatch. What do you think @alexcrichton?",FALSE,FALSE,66,34,71,5,TRUE,TRUE,TRUE,TRUE,0,35
Yamakaky,"@alexcrichton I think I'm ready for a final review. I'm only on linux, so I was not able to test on windows and such. As I moved code around, there is probably at least some unused imports.I removed the prefix removing for libraries and std as it involves more changes in rustc. That will be for another PR.",FALSE,FALSE,58,35,72,0,TRUE,TRUE,FALSE,TRUE,0,36
alexcrichton,"I may have missed it, but where did these changes come from? How come we're handling different return codes now?",FALSE,TRUE,20,36,74,1,FALSE,TRUE,FALSE,TRUE,0,37
Yamakaky,"http://git.savannah.gnu.org/gitweb/?p=libunwind.git;a=blob;f=src/unwind/Backtrace.c;hb=bc8698fd7ed13a629a8ec3cb2a89bd74f9d8b5c0_Unwind_Backtrace only return some values.",FALSE,FALSE,5,37,75,0,TRUE,FALSE,FALSE,TRUE,0,38
alexcrichton,"Sure yeah I can imagine that this function returns a number of values, but we weren't checking any of them before, only for errors. What prompted the change in logic?",FALSE,TRUE,30,38,77,1,FALSE,TRUE,FALSE,TRUE,0,39
Yamakaky,"I thought it was better to handle error codes. Was I wrong?",FALSE,FALSE,12,39,78,0,TRUE,TRUE,FALSE,TRUE,0,40
alexcrichton,"Oh no that's fine, I'm just trying to understand why. Did this come up during testing? Was this just done on a whim? Have these code paths been executed? etc.",FALSE,TRUE,30,40,80,1,FALSE,TRUE,FALSE,TRUE,0,41
alexcrichton,"I'm wary of these sorts of changes because libunwind's cross-platform behavior is notoriously finnicky, so I just wanted to dig into what prompted this change. My guess is that it's fine to land as such, but I just want to make sure.",FALSE,TRUE,42,40,81,2,FALSE,TRUE,FALSE,TRUE,0,41
Yamakaky,"No, I just found it strange to ignore the error case (https://github.com/rust-lang/rust/blob/master/src/libstd/panicking.rs#L349, I'm watching ^^)",FALSE,FALSE,15,41,82,0,TRUE,TRUE,FALSE,TRUE,0,42
alexcrichton,"Hm I feel like we're still not getting to an answer to my question. The code you linked to ignores errors because it has nowhere to pass the errors to and the information is just advisory, so it's fine to just ignore errors.",FALSE,TRUE,43,42,83,0,FALSE,TRUE,FALSE,TRUE,0,43
alexcrichton,"My question is why did this change happen? Is it purely being proactive? Was it reactive to some problem?",FALSE,TRUE,19,42,85,2,FALSE,TRUE,FALSE,TRUE,0,43
Yamakaky,"No, I added it for the reasons explained above, without detected problems",FALSE,FALSE,12,43,86,0,TRUE,TRUE,FALSE,TRUE,0,44
alexcrichton,"Below it printed addr - 1, but that seems to have been lost here?",FALSE,TRUE,14,44,87,0,FALSE,FALSE,FALSE,TRUE,0,45
Yamakaky,"Yeah, not sure why there is this -1, but it was probably important XD",FALSE,FALSE,14,45,88,0,TRUE,TRUE,FALSE,TRUE,0,46
alexcrichton,"This semicolon seems like it'd cause a compile failure? And the to_bytes doesn't seem to match the &'static str return type?",FALSE,TRUE,21,46,89,0,FALSE,TRUE,FALSE,TRUE,0,47
Yamakaky,"Coding without compiler is not a good idea",FALSE,FALSE,8,47,90,0,TRUE,FALSE,FALSE,TRUE,0,48
alexcrichton,"Stylistically we typically indent where clauses like these over one",FALSE,TRUE,10,48,91,0,FALSE,FALSE,FALSE,TRUE,0,49
alexcrichton,"This type of Option<Option<&str>> seems to disagree with the tyep on the return of the function?",FALSE,TRUE,16,50,93,0,FALSE,TRUE,FALSE,TRUE,0,51
Yamakaky,"Oops, the  Some  shouldn't be there",FALSE,FALSE,6,51,94,0,TRUE,FALSE,TRUE,TRUE,0,52
alexcrichton,"The indentation here was a little confusing for me at first, perhaps the result of this could be bound to a let?",FALSE,TRUE,22,52,95,0,FALSE,FALSE,FALSE,TRUE,0,53
Yamakaky,"yes, you're right",FALSE,FALSE,3,53,96,0,TRUE,FALSE,FALSE,TRUE,0,54
alexcrichton,"I believe we can just remove this, right? (always fall through below)",FALSE,TRUE,12,54,97,0,FALSE,FALSE,FALSE,TRUE,0,55
alexcrichton,"Er so to clarify, we definitely can't panic while producing a backtrace. This is called during a panic, which would be a recursive panic, which we don't want to abort on. If we do end up handling this then we need to punt the error upwards and let the caller deal with it.",FALSE,TRUE,53,55,99,1,FALSE,TRUE,FALSE,TRUE,0,56
Yamakaky,"What do you suggest as return value?",FALSE,FALSE,7,57,102,1,TRUE,TRUE,FALSE,TRUE,0,58
alexcrichton,"Oh a bool or a Result would be fine",FALSE,TRUE,9,58,104,1,FALSE,TRUE,FALSE,TRUE,0,59
Yamakaky,"Yeah, sure, now that there is no cx.next_error ^^",FALSE,FALSE,9,59,105,0,TRUE,FALSE,FALSE,TRUE,0,60
Yamakaky,"In fact, if I replace it with a bool we will loose the io::Error on https://github.com/Yamakaky/rust/blob/better-backtrace/src/libstd/sys/windows/backtrace/mod.rs#L76. Is that what we want?",FALSE,FALSE,21,60,107,1,TRUE,TRUE,FALSE,TRUE,0,61
Yamakaky,"An alternative would be to return the already-decoded frames on error. Are you OK with that?",FALSE,FALSE,16,61,109,1,TRUE,TRUE,FALSE,TRUE,0,62
Yamakaky,"That's what I did, finally.",FALSE,FALSE,5,62,110,0,TRUE,TRUE,FALSE,TRUE,0,63
alexcrichton,"I think this field is no longer necessary, right? It was only used when we could generate an error during a backtrace by calling write!, but with that no longer happening the body of this function is infallible.",FALSE,TRUE,38,63,112,1,FALSE,TRUE,FALSE,TRUE,0,64
alexcrichton,"Could this return an error?",FALSE,TRUE,5,64,114,1,FALSE,TRUE,FALSE,TRUE,0,65
Yamakaky,"I see a few possibilities:",FALSE,FALSE,5,65,115,0,TRUE,FALSE,FALSE,TRUE,0,66
Yamakaky,"same handling than for _URC_FATAL_PHASE1_ERROR",FALSE,FALSE,5,65,116,1,TRUE,FALSE,FALSE,TRUE,0,66
Yamakaky,"above + print an error message",FALSE,FALSE,6,65,117,2,TRUE,FALSE,FALSE,TRUE,0,66
Yamakaky,"create a new error type and return it using io::ErrorKind::Other",FALSE,FALSE,10,65,118,3,TRUE,FALSE,FALSE,TRUE,0,66
alexcrichton,"Er sorry, what I mean is that this must not panic. It should return an error of some kind (Err(()) is fine) so the caller can deal with the failure.",FALSE,TRUE,30,66,120,1,FALSE,TRUE,TRUE,TRUE,0,67
alexcrichton,"Hm I'm a little worried about this signature, In this case at least on Windows I don't believe that the return lifetime is 'static, but rather tied to the stack frame. In that sense I think this may crash on windows?",FALSE,TRUE,41,67,122,1,FALSE,TRUE,FALSE,TRUE,0,68
Yamakaky,"Maybe then tie its lifetime to the one of BacktraceContext?",FALSE,FALSE,10,68,124,1,TRUE,TRUE,FALSE,TRUE,0,69
alexcrichton,"Unfortunately on Windows at least the lifetime is fundamentally tied to the stack frame, so it'll need to take a closure or something like that.",FALSE,TRUE,25,69,126,1,FALSE,TRUE,FALSE,TRUE,0,70
Yamakaky,"Do you know where in the doc it's written? At least, it's not at https://msdn.microsoft.com/en-us/library/windows/desktop/ms681323(v=vs.85).aspx. That would be good to add as a comment.",FALSE,FALSE,24,70,127,0,TRUE,TRUE,FALSE,TRUE,0,71
alexcrichton,"This is not documented because it's just part of the API. If you take a look at the implementation of resolve_symname you'll see that it creates a local SYMBOL_INFO on the stack. The function then returns a pointer into this structure. That'll cause segfaults on MSVC when executed.",FALSE,TRUE,48,71,128,0,FALSE,TRUE,FALSE,TRUE,0,72
Yamakaky,"Oh, I see. The troubles of unsafe ^^A possibility would be to return a Cow. That way, gnu returns a str and msvc returns a String.Another would be to use a callback, as you said. The implementation would be a bit more complicated, though.",FALSE,FALSE,44,72,130,1,TRUE,TRUE,FALSE,TRUE,0,73
alexcrichton,"cc @rust-lang/libs I think this is getting close to merging, and would be good to get some more eyes on the new output format here!",FALSE,TRUE,25,73,131,0,FALSE,TRUE,FALSE,TRUE,0,74
sfackler,"Assuming the example in the PR message is up to date, this looks awesome!",FALSE,FALSE,14,74,132,0,FALSE,TRUE,FALSE,TRUE,0,75
Yamakaky,"It is, except the  builtin file  part ;)",FALSE,FALSE,8,75,133,0,TRUE,FALSE,FALSE,TRUE,0,76
purpleposeidon,"I'd love me some easy-reading stack traces! I have some hopefully-not-too-bike-shedding remarks.",FALSE,FALSE,12,76,134,0,FALSE,TRUE,FALSE,TRUE,0,77
purpleposeidon,"Here's how I'd format it:",FALSE,FALSE,5,76,135,1,FALSE,TRUE,FALSE,TRUE,0,77
purpleposeidon,"The frame numbers, while not particularly distracting, AFAIK aren't generally useful. Same story with { skipping N frames }.",FALSE,FALSE,19,76,136,2,FALSE,TRUE,FALSE,TRUE,0,77
purpleposeidon,"Java stacktraces have the function + symbol position on the same line, which certainly keeps things short, but is maybe a bit too dense:",FALSE,FALSE,24,76,137,3,FALSE,TRUE,FALSE,TRUE,0,77
purpleposeidon,"(It's calling std  std  instead of builtin now?)",FALSE,FALSE,8,76,138,4,FALSE,FALSE,FALSE,TRUE,0,77
purpleposeidon,"It might be cool to use some terminal::escape::codes on the function names to help them stand out from the package path. (Technology from the past! Save the future!) Maybe that's taking it too far? Parsing terminfo sounds like too much for a stacktrace printer to do...",FALSE,FALSE,46,76,140,6,FALSE,TRUE,FALSE,TRUE,0,77
Yamakaky,"Good ideas. The printing format is a quick change, there are certainly things to improve.I removed the prefix removal for std for now, it will be for another PR.",FALSE,FALSE,29,77,141,0,TRUE,TRUE,FALSE,TRUE,0,78
Yamakaky,"rebased to upstream",FALSE,FALSE,3,78,142,0,TRUE,FALSE,FALSE,TRUE,0,79
alexcrichton,"@Yamakaky this still exhibits the unsafety on MSVC I believe I pointed out before, so we can't merge until that's resolved.",FALSE,TRUE,21,79,143,0,FALSE,TRUE,FALSE,TRUE,0,80
Yamakaky,"Sorry, forgot about this problem. Should be good now.",FALSE,TRUE,9,80,144,0,TRUE,TRUE,FALSE,TRUE,0,81
oli-obk,"travis complains:",FALSE,FALSE,2,81,145,0,FALSE,FALSE,FALSE,TRUE,0,82
oli-obk,"/checkout/src/libstd/sys_common/backtrace.rs:51: line longer than 100 chars/checkout/src/libstd/sys/windows/backtrace/printing/mod.rs: incorrect license",FALSE,FALSE,8,81,146,1,FALSE,FALSE,FALSE,TRUE,0,82
oli-obk,"failures:[run-pass] run-pass/backtrace-debuginfo.rs[run-pass] run-pass/backtrace.rs",FALSE,FALSE,3,83,148,0,FALSE,FALSE,FALSE,TRUE,0,84
Yamakaky,"Not sure what's the problem...",FALSE,TRUE,5,84,149,0,TRUE,FALSE,FALSE,TRUE,0,85
alexcrichton,"This is still a memory safety violation, it's returning a borrowed pointer into a stack-local.",FALSE,TRUE,15,85,151,1,FALSE,TRUE,FALSE,TRUE,0,86
alexcrichton,"This function should likely just take a closure to call.",FALSE,TRUE,10,85,152,2,FALSE,TRUE,TRUE,TRUE,0,86
Yamakaky,"Oops, wrong variant.",FALSE,TRUE,3,86,153,0,TRUE,FALSE,FALSE,TRUE,0,87
alexcrichton,"I think this is still an issue in the sense that we should use a closure here. We should strive to avoid allocations in backtraces because they're often generated in limited context situations (panics, aborts, etc), where touching as little as possible is advantageous.",FALSE,TRUE,44,87,155,1,FALSE,TRUE,TRUE,TRUE,0,88
Yamakaky,"Ok, let's use a callback then ^^",FALSE,TRUE,7,88,156,0,TRUE,FALSE,FALSE,TRUE,0,89
Yamakaky,"Done.Where do you think I should put some doc about the functions defined in sys/? In the header of sys_common/backtrace.rs?",FALSE,TRUE,20,89,157,0,TRUE,TRUE,TRUE,TRUE,0,90
alexcrichton,"Implementation-wise this is looking better to me, thanks! I think the locking story still needs to be fixed up, though. Previously everything was basically single-threaded for most implementations because most of the library support here isn't threadsafe (e.g. windows and libbacktrace). In the restructuring locks were preserved for windows but not for libbacktrace (e.g. when resolving symbols), I believe.",FALSE,TRUE,59,90,158,0,FALSE,TRUE,FALSE,TRUE,0,91
alexcrichton,"Can the locking all be moved to the common path? That way implementations don't have to have lots of little locks themselves.",FALSE,TRUE,22,90,160,2,FALSE,TRUE,FALSE,TRUE,0,91
Yamakaky,"You mean, we put a lock to protect backtrace::print?",FALSE,TRUE,9,91,162,1,TRUE,TRUE,FALSE,TRUE,0,92
alexcrichton,"Yeah just throwing a lock around the whole operation is fine (it's wanted anyway to avoid concurrent backtrace prints)",FALSE,TRUE,19,92,164,1,FALSE,TRUE,FALSE,TRUE,0,93
Yamakaky,"Should I remove the lock in the windows implementation then?",FALSE,TRUE,10,93,166,1,TRUE,TRUE,FALSE,TRUE,0,94
alexcrichton,"Hm I think I've mentioned this before, but this cannot do operations such as print or allocate. This needs to return an error code.",FALSE,TRUE,24,94,168,1,FALSE,TRUE,FALSE,TRUE,0,95
alexcrichton,"Locks like this can be removed now that the global operation is locked.",FALSE,TRUE,13,95,169,0,FALSE,FALSE,FALSE,TRUE,0,96
alexcrichton,"@Yamakaky any luck with the failing tests?",FALSE,TRUE,7,96,170,0,FALSE,FALSE,FALSE,TRUE,0,97
Yamakaky,"I don't really understand what the tests do so it's difficult to fix them ^^",FALSE,TRUE,15,97,171,0,TRUE,FALSE,FALSE,TRUE,0,98
alexcrichton,"Given the test logs it looks like output isn't being found when it's expected. Looking at the test it seems that some of the line number information is slightly off. Are you sure that the method backends are called for information is the exact same as before?",FALSE,TRUE,47,98,172,0,FALSE,TRUE,FALSE,TRUE,0,99
alexcrichton,"I think this is close enough that we're ready to consider merging. I'm going to propose merging this but I'm curious how @rust-lang/libs feels about the change in format by default for backtraces.",FALSE,TRUE,33,99,173,0,FALSE,TRUE,FALSE,TRUE,0,100
alexcrichton,"@rfcbot fcp merge",FALSE,TRUE,3,99,174,1,FALSE,FALSE,FALSE,TRUE,0,100
alexcrichton,">>>rfcbot, edited by brson",FALSE,TRUE,4,99,175,2,FALSE,FALSE,FALSE,TRUE,0,100
alexcrichton,"Team member @alexcrichton has proposed to merge this. The next step is review by the rest of the tagged teams:",FALSE,TRUE,20,99,176,3,FALSE,TRUE,FALSE,TRUE,0,100
alexcrichton,"No concerns currently listed.",FALSE,TRUE,4,99,183,10,FALSE,TRUE,FALSE,TRUE,0,100
alexcrichton,"Once these reviewers reach consensus, this will enter its final comment period. If you spot a major issue that hasn't been raised at any point in this process, please speak up!",FALSE,TRUE,31,99,184,11,FALSE,TRUE,FALSE,TRUE,0,100
alexcrichton,"See this document for info about what commands tagged team members can give me.",FALSE,TRUE,14,99,185,12,FALSE,TRUE,FALSE,TRUE,0,100
Yamakaky,"Update output example.",FALSE,TRUE,3,100,186,0,TRUE,FALSE,FALSE,TRUE,0,101
brson,"It looks to me like the op switches the display order of stack frames, so main is displayed first, whereas it used to be last. Is that accurate? If that's the case, is the 'full' option also reversed, or is it in the 'old' order for backwards compatibility (I think we should be consistent in the order)?",FALSE,TRUE,57,101,189,2,FALSE,TRUE,TRUE,TRUE,0,102
brson,"Can the formatting scheme here be duplicated out of tree so that others using libbacktrace can imitate the official formatting (error-chain e.g. captures backtraces)?",FALSE,TRUE,24,101,190,3,FALSE,TRUE,FALSE,TRUE,0,102
Yamakaky,"In fact, I think we could even extract the entire backtrace handling to a separate crate. Could we do that after this PR, though? ^^",FALSE,TRUE,25,102,192,1,TRUE,TRUE,FALSE,TRUE,0,103
alexcrichton,"@brson I personally expected the ordering to stay the same, just the prefix/suffix removed and the output a little different. @Yamakaky can you confirm that the ordering is the same?",FALSE,TRUE,30,103,194,1,FALSE,TRUE,FALSE,TRUE,0,104
Yamakaky,"I don't remember changing the order, I'll check.",FALSE,TRUE,8,104,195,0,TRUE,TRUE,FALSE,TRUE,0,105
Yamakaky,"No, it's the same order. Someone talked about reversing the order, but it was not implemented.",FALSE,TRUE,16,105,197,1,TRUE,TRUE,FALSE,TRUE,0,106
emilk,"To (optionally) reverse the stack trace order is a separate issue and should/will be a separate PR: #38873 (comment)",FALSE,FALSE,19,106,198,0,FALSE,TRUE,TRUE,TRUE,0,107
Yamakaky,"Yes, that's it ^^",FALSE,TRUE,4,107,199,0,TRUE,FALSE,FALSE,TRUE,0,108
aturon,"Looks beautiful!",FALSE,TRUE,2,108,200,0,FALSE,FALSE,FALSE,TRUE,0,109
bors,"â˜”ï¸? The latest upstream changes (presumably #39234) made this pull request unmergeable. Please resolve the merge conflicts.",FALSE,FALSE,17,109,201,0,FALSE,TRUE,FALSE,TRUE,0,110
Yamakaky,"I think I found why the test fails. The backtrace contains the file:line of the functions and not the file:line of the lines that failed. Just have to find why that's the case.",FALSE,TRUE,33,110,202,0,TRUE,TRUE,FALSE,TRUE,0,111
Yamakaky,"Yeay !I think we could take all the backtrace handling code in std, convert it to no_std and use it as a dependency of std. That way, it could be published to crates.io and used as a dependency of https://crates.io/crates/backtrace. Could we do that in an other PR, though?",FALSE,TRUE,49,111,204,1,TRUE,TRUE,FALSE,TRUE,0,112
Yamakaky,"Anything missing before merge?Also, moving the conversation about putting the code in a separate crate to #39503.",FALSE,TRUE,17,112,205,0,TRUE,FALSE,FALSE,TRUE,0,113
alexcrichton,"ping @brson (checkbox)",FALSE,TRUE,3,113,206,0,FALSE,FALSE,FALSE,TRUE,0,114
Yamakaky,"Oh, yeah, right.",FALSE,TRUE,3,114,207,0,TRUE,FALSE,FALSE,TRUE,0,115
brson,"@Yamakaky can you paste some output for how the backtraces look now?",FALSE,TRUE,12,115,208,0,FALSE,FALSE,FALSE,TRUE,0,116
rfcbot,"ðŸ”” This is now entering its final comment period, as per the review above. ðŸ””",FALSE,TRUE,15,116,209,0,FALSE,TRUE,FALSE,TRUE,0,117
Yamakaky,"Done in the first post of this thread.",FALSE,TRUE,8,117,210,0,TRUE,FALSE,FALSE,TRUE,0,118
alexcrichton,"@Yamakaky should the documentation be updated then? The docs in the book were changed but seem to reflect what I believe at this point is historical syntax.",FALSE,TRUE,27,118,211,0,FALSE,TRUE,TRUE,TRUE,0,119
Yamakaky,"Oh yeah, right. What should I change?",FALSE,TRUE,7,119,212,0,TRUE,TRUE,TRUE,TRUE,0,120
alexcrichton,"src/doc/book/functions.md is the one I'm looking at, and I think it may be the only one.",FALSE,TRUE,16,120,213,0,FALSE,TRUE,FALSE,TRUE,0,121
alexcrichton,"Looking at the current format, how come the numbers were elided? I could imagine that without file/line numbers that the format may be difficult to parse if there's not line numbers demarcating entries perhaps?",FALSE,TRUE,34,120,215,2,FALSE,TRUE,FALSE,TRUE,0,121
alexcrichton,"Can you also extend an existing test (or add a new one) which asserts that by default the standard library pieces aren't printed? And then with RUST_BACKTRACE=full they are indeed printed?",FALSE,TRUE,31,120,216,3,FALSE,TRUE,FALSE,TRUE,0,121
brson,"Thanks @Yamakaky.",FALSE,TRUE,2,121,217,0,FALSE,FALSE,FALSE,TRUE,0,122
brson,"@Yamakaky do you mind showing both the short and full cases for the same stack trace, for comparison?",FALSE,TRUE,18,122,218,0,FALSE,FALSE,FALSE,TRUE,0,123
Yamakaky,"Done for the doc@brson doneOn it for the test.Line numbers: makes sense, on it.",FALSE,TRUE,14,123,219,0,TRUE,FALSE,FALSE,TRUE,0,124
Yamakaky,"Done for the frame number",FALSE,TRUE,5,124,220,0,TRUE,FALSE,FALSE,TRUE,0,125
nrc,"In the example in the OP, the short and full traces don't seem to correspond? One has fail and one has diverge.",FALSE,FALSE,22,125,221,0,FALSE,TRUE,FALSE,TRUE,0,126
nrc,"Is it correct that this only elides frames from the top and bottom of the trace?",FALSE,FALSE,16,125,223,2,FALSE,TRUE,FALSE,TRUE,0,126
Yamakaky,"Oh, should check for the doc.Yes, it doesn't remove frames in the middle.",FALSE,TRUE,13,126,225,1,TRUE,TRUE,TRUE,TRUE,0,127
Yamakaky,"Added test.@nrc where is the problem in the doc?",FALSE,TRUE,9,127,226,0,TRUE,FALSE,FALSE,TRUE,0,128
alexcrichton,"Asserting this symbol and _start below are present is likely to fail on non-linux platforms, perhaps those symbols could be tested on just Linux? Otherwise looks good to me!",FALSE,TRUE,29,128,228,1,FALSE,TRUE,FALSE,TRUE,0,129
alexcrichton,"Thanks for the update @Yamakaky as well as the gists in the OP, the outputs look great to me.",FALSE,TRUE,19,130,230,0,FALSE,TRUE,FALSE,TRUE,0,131
alexcrichton,"@brson, how do you feel about those traces?",FALSE,TRUE,8,130,231,1,FALSE,FALSE,FALSE,TRUE,0,131
brson,"@Yamakaky thanks for the updates. The results look fantastic.",FALSE,TRUE,9,131,232,0,FALSE,TRUE,FALSE,TRUE,0,132
brson,"The only qualm I have is slight:",FALSE,TRUE,7,131,233,1,FALSE,TRUE,FALSE,TRUE,0,132
brson,"Here there are three lines of text output and the capitalization and punctuation appear a bit inconsistent. Particularly with that capital Some.",FALSE,TRUE,22,131,235,3,FALSE,TRUE,FALSE,TRUE,0,132
brson,"Here's what happens today on a non-backtrace panic:",FALSE,TRUE,8,131,236,4,FALSE,TRUE,FALSE,TRUE,0,132
brson,"So istm there are three modes here, no backtrace, short backtrace, full backtrace, and they should be as consistent as possible. For sake of comparison here's the full case as of this PR:",FALSE,TRUE,33,131,238,6,FALSE,TRUE,TRUE,TRUE,0,132
brson,"Here's an attempt to make them more consistent:",FALSE,TRUE,8,131,239,7,FALSE,TRUE,FALSE,TRUE,0,132
brson,"Yes, that looks good to me. The only thing I changed was to preface 'Some details are omitted' with 'note:'.",FALSE,TRUE,20,131,240,8,FALSE,TRUE,FALSE,TRUE,0,132
brson,"@Yamakaky can you make that one change?",FALSE,TRUE,7,131,241,9,FALSE,FALSE,FALSE,TRUE,0,132
brson,"I'm happy for this to fcp now. Thanks @Yamakaky, this is a great improvement.",FALSE,TRUE,14,131,242,10,FALSE,TRUE,FALSE,TRUE,0,132
brson,"@nrc Yes I believe that is correct - the op examples are from different source.",FALSE,TRUE,15,132,243,0,FALSE,TRUE,FALSE,TRUE,0,133
Yamakaky,"I can add 6 chars ;)",FALSE,TRUE,6,133,244,0,TRUE,FALSE,FALSE,TRUE,0,134
alexcrichton,"Great! @Yamakaky can you squash the commits down and I'll r+?",FALSE,TRUE,11,134,245,0,FALSE,TRUE,FALSE,TRUE,0,135
Yamakaky,"You mean all in one commit?",FALSE,TRUE,6,135,246,0,TRUE,FALSE,FALSE,TRUE,0,136
alexcrichton,"Multiple commits are fine (if they're logically separated), but this probably doesn't need 54 commits",FALSE,TRUE,15,136,247,0,FALSE,FALSE,FALSE,TRUE,0,137
Yamakaky,"Should be good.",FALSE,TRUE,3,137,248,0,TRUE,FALSE,FALSE,TRUE,0,138
alexcrichton,"@bors: r+",FALSE,TRUE,2,138,249,0,FALSE,FALSE,FALSE,TRUE,0,139
alexcrichton,"Thanks again for your patience @Yamakaky!",FALSE,TRUE,6,138,250,1,FALSE,TRUE,FALSE,TRUE,0,139
bors,"ðŸ“Œ Commit 6277694 has been approved by alexcrichton",FALSE,TRUE,8,139,251,0,FALSE,TRUE,FALSE,TRUE,0,140
bors,"â˜”ï¸? The latest upstream changes (presumably #39638) made this pull request unmergeable. Please resolve the merge conflicts.",FALSE,TRUE,17,140,252,0,FALSE,TRUE,FALSE,TRUE,0,141
bors,"ðŸ”’ Merge conflict",FALSE,TRUE,3,141,253,0,FALSE,TRUE,FALSE,TRUE,0,142
Yamakaky,"Done. Stop modifiying the backtrace code ! XD",FALSE,TRUE,8,142,254,0,TRUE,TRUE,FALSE,TRUE,0,143
alexcrichton,"Looks like Travis failed?",FALSE,TRUE,4,143,255,0,FALSE,TRUE,FALSE,TRUE,0,144
Yamakaky,"Oops, merge problem, should be good this time.",FALSE,TRUE,8,144,256,0,TRUE,FALSE,TRUE,TRUE,0,145
alexcrichton,"@bors: r+",FALSE,TRUE,2,145,257,0,FALSE,FALSE,FALSE,TRUE,0,146
bors,"ðŸ“Œ Commit fdd8c34 has been approved by alexcrichton",FALSE,TRUE,8,146,258,0,FALSE,TRUE,FALSE,TRUE,0,147
bors,"âŒ›ï¸? Testing commit fdd8c34 with merge e1045f4...",FALSE,TRUE,7,147,259,0,FALSE,TRUE,FALSE,TRUE,0,148
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,148,260,0,FALSE,TRUE,FALSE,TRUE,0,149
frewsxcv,"@bors r-",FALSE,FALSE,2,149,261,0,FALSE,FALSE,FALSE,TRUE,0,150
Yamakaky,"Missing comma in the mvsc code.",FALSE,TRUE,6,150,263,0,TRUE,FALSE,FALSE,TRUE,0,151
frewsxcv,"@bors r=alexcrichton",FALSE,FALSE,2,151,264,0,FALSE,FALSE,FALSE,TRUE,0,152
bors,"ðŸ“Œ Commit 54ffbe8 has been approved by alexcrichton",FALSE,TRUE,8,152,265,0,FALSE,TRUE,FALSE,TRUE,0,153
bors,"âŒ›ï¸? Testing commit 54ffbe8 with merge d9affc4...",FALSE,TRUE,7,153,266,0,FALSE,TRUE,FALSE,TRUE,0,154
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,154,267,0,FALSE,TRUE,FALSE,TRUE,0,155
Yamakaky,"We will see all the compilations errors I didn't see on Linux ^^",FALSE,TRUE,13,155,268,0,TRUE,TRUE,FALSE,TRUE,0,156
Yamakaky,"Will it be good this time?",FALSE,TRUE,6,156,269,0,TRUE,FALSE,FALSE,TRUE,0,157
alexcrichton,"@bors: r+",FALSE,TRUE,2,157,270,0,FALSE,FALSE,FALSE,TRUE,0,158
bors,"ðŸ“Œ Commit 86f5709 has been approved by alexcrichton",FALSE,TRUE,8,158,271,0,FALSE,TRUE,FALSE,TRUE,0,159
bors,"âŒ›ï¸? Testing commit 86f5709 with merge 9149b16...",FALSE,TRUE,7,159,272,0,FALSE,TRUE,FALSE,TRUE,0,160
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,160,273,0,FALSE,TRUE,FALSE,TRUE,0,161
Yamakaky,"Fixed issues",FALSE,TRUE,2,161,274,0,TRUE,FALSE,FALSE,TRUE,0,162
Yamakaky,"Add unsafe blocks since windows version of unwind_backtrace is no longer unsafe.",FALSE,TRUE,12,161,275,1,TRUE,TRUE,FALSE,TRUE,0,162
Yamakaky,"Could you relaunch the build please?",FALSE,TRUE,6,162,276,0,TRUE,FALSE,FALSE,TRUE,0,163
aturon,"@bors r=alexcrichton",FALSE,TRUE,2,163,277,0,FALSE,FALSE,FALSE,TRUE,0,164
bors,"ðŸ“Œ Commit c9b125b has been approved by alexcrichton",FALSE,TRUE,8,164,278,0,FALSE,TRUE,FALSE,TRUE,0,165
bors,"âŒ›ï¸? Testing commit c9b125b with merge 20bf23e...",FALSE,TRUE,7,165,279,0,FALSE,TRUE,FALSE,TRUE,0,166
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,166,280,0,FALSE,TRUE,FALSE,TRUE,0,167
Yamakaky,"Oops, should be return e instead of e?.",FALSE,TRUE,8,167,281,0,TRUE,FALSE,TRUE,TRUE,0,168
alexcrichton,"@bors: r+",FALSE,TRUE,2,168,282,0,FALSE,FALSE,FALSE,TRUE,0,169
bors,"ðŸ“Œ Commit 67d17e5 has been approved by alexcrichton",FALSE,TRUE,8,169,283,0,FALSE,TRUE,FALSE,TRUE,0,170
bors,"âŒ›ï¸? Testing commit 67d17e5 with merge 9b323ce...",FALSE,TRUE,7,170,284,0,FALSE,TRUE,FALSE,TRUE,0,171
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,171,285,0,FALSE,TRUE,FALSE,TRUE,0,172
Yamakaky,"Forgot a Result?",FALSE,TRUE,3,172,286,0,TRUE,TRUE,FALSE,TRUE,0,173
alexcrichton,"@bors: r+",FALSE,TRUE,2,173,287,0,FALSE,FALSE,FALSE,TRUE,0,174
bors,"ðŸ“Œ Commit 95ba9ab has been approved by alexcrichton",FALSE,TRUE,8,174,288,0,FALSE,TRUE,FALSE,TRUE,0,175
bors,"âŒ›ï¸? Testing commit 95ba9ab with merge 9ff8886...",FALSE,TRUE,7,175,289,0,FALSE,TRUE,FALSE,TRUE,0,176
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,176,290,0,FALSE,TRUE,FALSE,TRUE,0,177
Yamakaky,"We are at the unsafe checks, so we are near the end. Sorry for the multiple build request...",FALSE,TRUE,18,177,291,0,TRUE,TRUE,FALSE,TRUE,0,178
petrochenkov,"@YamakakyMaybe you could test it locally before sending to bors, using VMs or cross-compilation?Even with slow machine it's faster than repeated  fix -> reapprove -> send to Travis/Appveyor -> fail  cycles.",FALSE,FALSE,31,178,292,0,FALSE,TRUE,FALSE,TRUE,0,179
Yamakaky,"I'm stupid, I forgot about cross compilation...",FALSE,TRUE,7,179,293,0,TRUE,TRUE,FALSE,TRUE,0,180
petrochenkov,"@bors r=alexcrichton(The queue is empty anyway.)",FALSE,FALSE,6,180,294,0,FALSE,FALSE,FALSE,TRUE,0,181
bors,"ðŸ“Œ Commit 170251d has been approved by alexcrichton",FALSE,TRUE,8,181,295,0,FALSE,TRUE,FALSE,TRUE,0,182
bors,"âŒ›ï¸? Testing commit 170251d with merge d4a901b...",FALSE,TRUE,7,182,296,0,FALSE,TRUE,FALSE,TRUE,0,183
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,183,297,0,FALSE,TRUE,FALSE,TRUE,0,184
Yamakaky,"I have trouble cross-building on msvc, so I tried with gnu with hacks. Should be good.",FALSE,TRUE,16,184,298,0,TRUE,TRUE,FALSE,TRUE,0,185
petrochenkov,"@bors r=alexcrichton",FALSE,FALSE,2,185,299,0,FALSE,FALSE,FALSE,TRUE,0,186
bors,"ðŸ“Œ Commit 090e5a3 has been approved by alexcrichton",FALSE,TRUE,8,186,300,0,FALSE,TRUE,FALSE,TRUE,0,187
bors,"âŒ›ï¸? Testing commit 090e5a3 with merge 4b3f07d...",FALSE,TRUE,7,187,301,0,FALSE,TRUE,FALSE,TRUE,0,188
bors,"ðŸ’” Test failed - status-travis",FALSE,TRUE,5,188,302,0,FALSE,TRUE,FALSE,TRUE,0,189
Yamakaky,"Errors in mac code now XD",FALSE,TRUE,6,189,303,0,TRUE,TRUE,FALSE,TRUE,0,190
petrochenkov,"@bors r=alexcrichton",FALSE,FALSE,2,190,304,0,FALSE,FALSE,FALSE,TRUE,0,191
bors,"ðŸ“Œ Commit 03cae42 has been approved by alexcrichton",FALSE,TRUE,8,191,305,0,FALSE,TRUE,FALSE,TRUE,0,192
bors,"âŒ›ï¸? Testing commit 03cae42 with merge dbc7e2b...",FALSE,TRUE,7,192,306,0,FALSE,TRUE,FALSE,TRUE,0,193
Yamakaky,"Sorry, forgot to push a fix",FALSE,TRUE,6,193,307,0,TRUE,FALSE,FALSE,TRUE,0,194
petrochenkov,"@bors r-",FALSE,FALSE,2,194,308,0,FALSE,FALSE,FALSE,TRUE,0,195
petrochenkov,"@bors r=alexcrichton",FALSE,FALSE,2,195,309,0,FALSE,FALSE,FALSE,TRUE,0,196
bors,"ðŸ“Œ Commit 1522faa has been approved by alexcrichton",FALSE,TRUE,8,196,310,0,FALSE,TRUE,FALSE,TRUE,0,197
bors,"âŒ›ï¸? Testing commit 1522faa with merge b1b82e1...",FALSE,TRUE,7,197,311,0,FALSE,TRUE,FALSE,TRUE,0,198
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,198,312,0,FALSE,TRUE,FALSE,TRUE,0,199
Yamakaky,"Sorry again @alexcrichton and @petrochenkov for all the roundtrips...",FALSE,TRUE,9,199,313,0,TRUE,FALSE,FALSE,TRUE,0,200
Yamakaky,"This fail doesn't seem to be my fault",FALSE,TRUE,8,200,314,0,TRUE,FALSE,FALSE,TRUE,0,201
petrochenkov,"Looks spurious.@bors r=alexcrichton",FALSE,TRUE,3,201,315,0,FALSE,FALSE,FALSE,TRUE,0,202
bors,"ðŸ’¡ This pull request was already approved, no need to approve it again.",FALSE,TRUE,13,202,316,0,FALSE,TRUE,FALSE,TRUE,0,203
bors,"This pull request previously failed. You should add more commits to fix the bug, or use retry to trigger a build again.",FALSE,TRUE,22,202,317,1,FALSE,TRUE,TRUE,TRUE,0,203
bors,"ðŸ“Œ Commit 1522faa has been approved by alexcrichton",FALSE,TRUE,8,203,318,0,FALSE,TRUE,FALSE,TRUE,0,204
petrochenkov,"@bors retry",FALSE,TRUE,2,204,319,0,FALSE,FALSE,FALSE,TRUE,0,205
bors,"âŒ›ï¸? Testing commit 1522faa with merge fc059a8...",FALSE,TRUE,7,205,320,0,FALSE,TRUE,FALSE,TRUE,0,206
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,206,321,0,FALSE,TRUE,FALSE,TRUE,0,207
petrochenkov,"Ok, it doesn't looks spurious anymore.Let's wait for @alexcrichton.",FALSE,TRUE,9,207,322,0,FALSE,FALSE,FALSE,TRUE,0,208
alexcrichton,"It looks like https://api.pub.build.mozilla.org is down at the moment, so we'll need to wait for it to come back online",FALSE,TRUE,20,209,324,0,FALSE,FALSE,FALSE,TRUE,0,210
alexcrichton,"@bors: retry",FALSE,TRUE,2,210,325,0,FALSE,FALSE,FALSE,TRUE,0,211
bors,"âŒ›ï¸? Testing commit 1522faa with merge 22f651c...",FALSE,TRUE,7,211,326,0,FALSE,TRUE,FALSE,TRUE,0,212
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,212,327,0,FALSE,TRUE,FALSE,TRUE,0,213
Yamakaky,"The mac build is still failing because of api.pub.",FALSE,TRUE,9,213,328,0,TRUE,FALSE,FALSE,TRUE,0,214
alexcrichton,"@bors: r+",FALSE,TRUE,2,214,329,0,FALSE,FALSE,FALSE,TRUE,0,215
bors,"ðŸ“Œ Commit 7af51f6 has been approved by alexcrichton",FALSE,TRUE,8,215,330,0,FALSE,TRUE,FALSE,TRUE,0,216
bors,"âŒ›ï¸? Testing commit 7af51f6 with merge ef5fef9...",FALSE,TRUE,7,216,331,0,FALSE,TRUE,FALSE,TRUE,0,217
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,217,332,0,FALSE,TRUE,FALSE,TRUE,0,218
Yamakaky,"Warning of a field only used in some backend: it smells the end.",FALSE,TRUE,13,218,333,0,TRUE,FALSE,FALSE,TRUE,0,219
petrochenkov,"@bors r=alexcrichton",FALSE,TRUE,2,219,334,0,FALSE,FALSE,FALSE,TRUE,0,220
bors,"ðŸ“Œ Commit 0f6d17f has been approved by alexcrichton",FALSE,TRUE,8,220,335,0,FALSE,TRUE,FALSE,TRUE,0,221
bors,"âŒ›ï¸? Testing commit 0f6d17f with merge ed47c43...",FALSE,TRUE,7,221,336,0,FALSE,TRUE,FALSE,TRUE,0,222
Yamakaky,"Again, why isn't the appveyor build enabled for all pull requests?",FALSE,TRUE,11,222,337,0,TRUE,FALSE,FALSE,TRUE,0,223
bors,"ðŸ’” Test failed - status-travis",FALSE,TRUE,5,223,338,0,FALSE,TRUE,FALSE,TRUE,0,224
Yamakaky,"The emscripten build seems broken",FALSE,TRUE,5,224,339,0,TRUE,FALSE,FALSE,TRUE,0,225
alexcrichton,"@bors: retry",FALSE,TRUE,2,225,340,0,FALSE,FALSE,FALSE,TRUE,0,226
alexcrichton,"* sccache wedged #39003",FALSE,TRUE,4,225,341,1,FALSE,FALSE,FALSE,TRUE,0,226
alexcrichton,"On Sun, Feb 12, 2017 at 10:37 AM, Yamakaky ***@***.***> wrote:The emscripten build seems broken",FALSE,TRUE,15,225,343,3,FALSE,TRUE,FALSE,TRUE,0,226
alexcrichton,"â€”You are receiving this because you were mentioned.Reply to this email directly, view it on GitHub<#38165 (comment)>, or mutethe thread<https://github.com/notifications/unsubscribe-auth/AAD95AbbBRloAlV3o_24CDgXo8hsiEjmks5rbzVNgaJpZM4LDtfR>.",FALSE,TRUE,20,225,344,4,FALSE,TRUE,FALSE,TRUE,0,226
bors,"âŒ›ï¸? Testing commit 0f6d17f with merge a66dc5c...",FALSE,TRUE,7,226,345,0,FALSE,TRUE,FALSE,TRUE,0,227
bors,"ðŸ’” Test failed - status-travis",FALSE,TRUE,5,227,346,0,FALSE,TRUE,FALSE,TRUE,0,228
Yamakaky,"Moar syntax error, this time in osx code.",FALSE,TRUE,8,228,347,0,TRUE,FALSE,FALSE,TRUE,0,229
petrochenkov,"The ride never ends.jpg@bors r=alexcrichton",FALSE,TRUE,5,229,348,0,FALSE,FALSE,FALSE,TRUE,0,230
bors,"ðŸ“Œ Commit 767bb2a has been approved by alexcrichton",FALSE,TRUE,8,230,349,0,FALSE,TRUE,FALSE,TRUE,0,231
Yamakaky,"Builds failure for eternity",FALSE,TRUE,4,231,350,0,TRUE,FALSE,FALSE,TRUE,0,232
bors,"âŒ›ï¸? Testing commit 767bb2a with merge 6563127...",FALSE,TRUE,7,232,351,0,FALSE,TRUE,FALSE,TRUE,0,233
bors,"ðŸ’” Test failed - status-travis",FALSE,TRUE,5,233,352,0,FALSE,TRUE,FALSE,TRUE,0,234
bors,"â˜”ï¸? The latest upstream changes (presumably #39633) made this pull request unmergeable. Please resolve the merge conflicts.",FALSE,TRUE,17,234,353,0,FALSE,TRUE,FALSE,TRUE,0,235
Yamakaky,"Fix typo, rebased",FALSE,TRUE,3,235,354,0,TRUE,FALSE,FALSE,TRUE,0,236
alexcrichton,"@bors: r+",FALSE,TRUE,2,236,355,0,FALSE,FALSE,FALSE,TRUE,0,237
bors,"ðŸ“Œ Commit 485ecd7 has been approved by alexcrichton",FALSE,TRUE,8,237,356,0,FALSE,TRUE,FALSE,TRUE,0,238
Yamakaky,"BTW @alexcrichton: after this PR is merged, please @me in the following issues about backtraces. Now that I know how it works ;)",FALSE,TRUE,23,238,357,0,TRUE,TRUE,FALSE,TRUE,0,239
bors,"âŒ›ï¸? Testing commit 485ecd7 with merge 2e59ee2...",FALSE,TRUE,7,239,358,0,FALSE,TRUE,FALSE,TRUE,0,240
bors,"ðŸ’” Test failed - status-travis",FALSE,TRUE,5,240,359,0,FALSE,TRUE,FALSE,TRUE,0,241
rfcbot,"The final comment period is now complete.",FALSE,TRUE,7,241,360,0,FALSE,FALSE,FALSE,TRUE,0,242
alexcrichton,"@bors: r+",FALSE,TRUE,2,242,361,0,FALSE,FALSE,FALSE,TRUE,0,243
bors,"ðŸ“Œ Commit d50e4cc has been approved by alexcrichton",FALSE,TRUE,8,243,362,0,FALSE,TRUE,FALSE,TRUE,0,244
bors,"âŒ›ï¸? Testing commit d50e4cc with merge 9b7ac2b...",FALSE,TRUE,7,244,363,0,FALSE,TRUE,FALSE,TRUE,0,245
bors,"ðŸ’” Test failed - status-travis",FALSE,TRUE,5,245,364,0,FALSE,TRUE,FALSE,TRUE,0,246
alexcrichton,"@Yamakaky the same tests keeps failing, can you investigate?",FALSE,TRUE,9,246,365,0,FALSE,FALSE,FALSE,TRUE,0,247
Yamakaky,"I am!",FALSE,TRUE,2,247,366,0,TRUE,FALSE,FALSE,TRUE,0,248
alexcrichton,"Thanks @Yamakaky! Feel free to ping me with questions or whenever this PR is updated.",FALSE,TRUE,15,248,367,0,FALSE,TRUE,FALSE,TRUE,0,249
petrochenkov,"@YamakakyI've tested this PR locally and will sendsent you the fix soon.The errors on Windows are non-trivial, you'd never land this without local debugging.",FALSE,TRUE,24,249,368,0,FALSE,TRUE,FALSE,TRUE,0,250
petrochenkov,"Status of run-pass/backtrace.rs / run-pass/backtrace-debuginfo.rs:",FALSE,TRUE,5,249,369,1,FALSE,TRUE,FALSE,TRUE,0,250
petrochenkov,"Windows/GNU 64-bit - Fixed",FALSE,TRUE,4,249,370,2,FALSE,TRUE,FALSE,TRUE,0,250
petrochenkov,"Windows/GNU 32-bit - Fixed",FALSE,TRUE,4,249,371,3,FALSE,TRUE,FALSE,TRUE,0,250
petrochenkov,"Windows/MSVC 64-bit - Fixed",FALSE,TRUE,4,249,372,4,FALSE,TRUE,FALSE,TRUE,0,250
petrochenkov,"Windows/MSVC 32-bit - Was always broken. Not sure how it passes through Appveyor.",FALSE,TRUE,13,249,373,5,FALSE,TRUE,FALSE,TRUE,0,250
Yamakaky,"Cool, thanks!",FALSE,TRUE,2,250,374,0,TRUE,FALSE,FALSE,TRUE,0,251
petrochenkov,"@YamakakyThis test condition may be too strict:",FALSE,TRUE,7,251,375,0,FALSE,FALSE,FALSE,TRUE,0,252
petrochenkov,"Symbols in the bottom of the stack are very platform specific, mangled name returned from resolve_symname is platform specific too, some targets have incomplete backtraces with garbage like mingw_set_invalid_parameter_handler or even <unknown>.If anything of this stays unremoved, then std::panicking somewhere in the middle of backtrace will stay too, and the test will fail.I recommend to disable this check for everything except for few tier1 platforms with good backtrace support if Travis continues failing on other platforms.",FALSE,TRUE,76,251,377,2,FALSE,TRUE,FALSE,TRUE,0,252
petrochenkov,"@bors r+",FALSE,TRUE,2,252,378,0,FALSE,FALSE,FALSE,TRUE,0,253
bors,"ðŸ“Œ Commit 0982a28 has been approved by petrochenkov",FALSE,TRUE,8,253,379,0,FALSE,TRUE,FALSE,TRUE,0,254
bors,"âŒ›ï¸? Testing commit 0982a28 with merge a5c2937...",FALSE,TRUE,7,254,380,0,FALSE,TRUE,FALSE,TRUE,0,255
bors,"ðŸ’” Test failed - status-travis",FALSE,TRUE,5,255,381,0,FALSE,TRUE,FALSE,TRUE,0,256
petrochenkov,"run-pass/backtrace.rs fails on ARM in qemu due to this failed assertion",FALSE,TRUE,11,256,382,0,FALSE,TRUE,FALSE,TRUE,0,257
petrochenkov,"because the output looks like this",FALSE,TRUE,6,256,383,1,FALSE,FALSE,FALSE,TRUE,0,257
petrochenkov,"and doesn't contain neither foo nor any backtrace at all.",FALSE,TRUE,10,256,384,2,FALSE,FALSE,FALSE,TRUE,0,257
Yamakaky,"Maybe, as you said, only test the tier 1 platforms?",FALSE,TRUE,10,257,385,0,TRUE,FALSE,FALSE,TRUE,0,258
petrochenkov,"@YamakakyThe ARM issue from Travis is a regression, not just a lacking backtrace support.I've reproduced it user mode qemu as well and it doesn't happen on master._Unwind_Backtrace returns bad _Unwind_Reason_Code with this patch for some reason, I haven't investigated further yet.",FALSE,TRUE,41,258,387,1,FALSE,TRUE,FALSE,TRUE,0,259
alexcrichton,"@bors: r+",FALSE,TRUE,2,259,388,0,FALSE,FALSE,FALSE,TRUE,0,260
bors,"ðŸ“Œ Commit 53a5d56 has been approved by alexcrichton",FALSE,TRUE,8,260,389,0,FALSE,TRUE,FALSE,TRUE,0,261
bors,"âŒ›ï¸? Testing commit 53a5d56 with merge 957c33c...",FALSE,TRUE,7,261,390,0,FALSE,TRUE,FALSE,TRUE,0,262
bors,"ðŸ’” Test failed - status-travis",FALSE,TRUE,5,262,391,0,FALSE,TRUE,FALSE,TRUE,0,263
petrochenkov,"@bors r+",FALSE,TRUE,2,263,392,0,FALSE,FALSE,FALSE,TRUE,0,264
bors,"ðŸ“Œ Commit c8b1742 has been approved by petrochenkov",FALSE,TRUE,8,264,393,0,FALSE,TRUE,FALSE,TRUE,0,265
bors,"âŒ›ï¸? Testing commit c8b1742 with merge 7f82f03...",FALSE,TRUE,7,265,394,0,FALSE,TRUE,FALSE,TRUE,0,266
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,266,395,0,FALSE,TRUE,FALSE,TRUE,0,267
petrochenkov,"Some new frame that needs to be filtered away on Windows/GNU, probably due to enabled debug assertions on Appveyor, I tested everything in release mode.",FALSE,TRUE,25,267,396,0,FALSE,TRUE,FALSE,TRUE,0,268
petrochenkov,"@YamakakyI think we need to remove the // Make sure than the short version cleans the backtrace. part of the test completely.It was tested manually and works reasonably in common configurations, but supporting the guarantee that all these symbols will be filtered on all platforms in all configurations will be a huge PITA, given that we can't do this even for officially tested configurations.",FALSE,TRUE,64,268,398,1,FALSE,TRUE,FALSE,TRUE,0,269
petrochenkov,"Meanwhile, I fixed the test in Windows+Debug configurations (Yamakaky#4), let's try to land it as is once more.",FALSE,TRUE,18,269,399,0,FALSE,TRUE,FALSE,TRUE,0,270
petrochenkov,"@bors r+",FALSE,TRUE,2,270,400,0,FALSE,FALSE,FALSE,TRUE,0,271
bors,"ðŸ“Œ Commit 9e054cf has been approved by petrochenkov",FALSE,TRUE,8,271,401,0,FALSE,TRUE,FALSE,TRUE,0,272
Yamakaky,"So you think this part of the test should be removed?",FALSE,TRUE,11,272,402,0,TRUE,FALSE,TRUE,TRUE,0,273
petrochenkov,"@YamakakyIf it fails 1-2 more Travis runs, then yes.",FALSE,TRUE,9,273,403,0,FALSE,TRUE,FALSE,TRUE,0,274
bors,"âŒ›ï¸? Testing commit 9e054cf with merge 4b31fca...",FALSE,TRUE,7,274,404,0,FALSE,TRUE,FALSE,TRUE,0,275
bors,"ðŸ’” Test failed - status-travis",FALSE,TRUE,5,275,405,0,FALSE,TRUE,FALSE,TRUE,0,276
petrochenkov,"@bors r+",FALSE,TRUE,2,276,406,0,FALSE,FALSE,FALSE,TRUE,0,277
bors,"ðŸ“Œ Commit d0fe018 has been approved by petrochenkov",FALSE,TRUE,8,277,407,0,FALSE,TRUE,FALSE,TRUE,0,278
bors,"âŒ›ï¸? Testing commit d0fe018 with merge fe43a3b...",FALSE,TRUE,7,278,408,0,FALSE,TRUE,FALSE,TRUE,0,279
bors,"ðŸ’” Test failed - status-travis",FALSE,TRUE,5,279,409,0,FALSE,TRUE,FALSE,TRUE,0,280
Yamakaky,"So close!",FALSE,TRUE,2,280,410,0,TRUE,FALSE,FALSE,TRUE,0,281
petrochenkov,"You need to add std::panic in all variations:",FALSE,TRUE,8,281,412,1,FALSE,TRUE,FALSE,TRUE,0,282
petrochenkov,"(I'd also keep  std::panicking  just for clarity)",FALSE,TRUE,7,281,413,2,FALSE,FALSE,FALSE,TRUE,0,282
Yamakaky,"Oops, right",FALSE,TRUE,2,282,414,0,TRUE,FALSE,FALSE,TRUE,0,283
petrochenkov,"@bors r+",FALSE,TRUE,2,283,415,0,FALSE,FALSE,FALSE,TRUE,0,284
bors,"ðŸ“Œ Commit 52bed53 has been approved by petrochenkov",FALSE,TRUE,8,284,416,0,FALSE,TRUE,FALSE,TRUE,0,285
bors,"âŒ›ï¸? Testing commit 52bed53 with merge bea2b27...",FALSE,TRUE,7,285,417,0,FALSE,TRUE,FALSE,TRUE,0,286
bors,"ðŸ’” Test failed - status-appveyor",FALSE,TRUE,5,286,418,0,FALSE,TRUE,FALSE,TRUE,0,287
petrochenkov,"Both Travis and Appveyor failed.Travis on the next test condition",FALSE,TRUE,10,287,419,0,FALSE,TRUE,FALSE,TRUE,0,288
petrochenkov,"Appveyor on the  classic  one (WTF, I tested this locally in this exact configuration)",FALSE,TRUE,14,287,420,1,FALSE,TRUE,FALSE,TRUE,0,288
petrochenkov,"Time to drop both Make sure than the short... and Only on linux for _start... conditions.",FALSE,TRUE,16,287,421,2,FALSE,TRUE,FALSE,TRUE,0,288
Yamakaky,"I'm thinking: what if we captured a stacktrace juste before the main, then substract it to the backtrace on panic? That way, at least the bottom of the trace would be correct all the time.",FALSE,TRUE,35,288,423,1,TRUE,TRUE,FALSE,TRUE,0,289
Yamakaky,"Maybe we could do the same for the top, in std::panicking::begin_panic, core::result::unwrap_failed... It would be easier to maintain.",FALSE,TRUE,18,288,425,3,TRUE,TRUE,FALSE,TRUE,0,289
Yamakaky,"Not sure how it would play with inlining. inline(never) should do the trick.",FALSE,TRUE,13,288,427,5,TRUE,TRUE,TRUE,TRUE,0,289
petrochenkov,"This one failed on Travis too.",FALSE,TRUE,6,289,428,0,FALSE,TRUE,FALSE,TRUE,0,290
petrochenkov,"@YamakakyMaybe as a next PR?The problem of this patch is that it already tries to change far too much platform-specific code at once and is pending for too long.If main and panic start can be reliably detected in presence of inlining and custom mains, then yes, it would be a more robust solution, this needs some experimentation.",FALSE,TRUE,57,290,430,1,FALSE,TRUE,FALSE,TRUE,0,291
petrochenkov,"@bors r+",FALSE,TRUE,2,291,431,0,FALSE,FALSE,FALSE,TRUE,0,292
bors,"ðŸ“Œ Commit 6398b20 has been approved by petrochenkov",FALSE,TRUE,8,292,432,0,FALSE,TRUE,FALSE,TRUE,0,293
bors,"âŒ›ï¸? Testing commit 6398b20 with merge 4be034e...",FALSE,TRUE,7,293,433,0,FALSE,TRUE,FALSE,TRUE,0,294
bors,"â˜€ï¸? Test successful - status-appveyor, status-travisApproved by: petrochenkovPushing 4be034e to master...",FALSE,TRUE,11,294,434,0,FALSE,TRUE,FALSE,TRUE,0,295
jdm,"Does this also affect the output of https://crates.io/crates/backtrace or should we file a separate issue in that repository?",FALSE,FALSE,18,296,436,0,FALSE,FALSE,TRUE,TRUE,0,297
Yamakaky,"You should open an issue.",FALSE,TRUE,5,297,437,0,TRUE,FALSE,TRUE,TRUE,0,298
