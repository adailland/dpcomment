% Generated by Discussion model node.12442.txt
% File generated on 2017/08/11 11:55:41

@relation pr1502466941168

@attribute author String
@attribute textual String
@attribute isProjectMember {TRUE, FALSE}
@attribute isInvited {TRUE, FALSE}
@attribute numberOfWords numeric
@attribute commentsSoFar numeric
@attribute allUtterancesSoFar numeric
@attribute utterancesInCommentSoFar numeric
@attribute utteredByOriginalPoster {TRUE, FALSE}
@attribute hasCapitalizedWord {TRUE, FALSE}
@attribute containsShould {TRUE, FALSE}
@attribute hasDecisions {TRUE, FALSE}
@attribute howManyDecisions numeric
@attribute idComment numeric
@attribute idPara numeric

@data
addaleax,"See nodejs/CTC#12 for discussion/background. I would say that that thread is a better place for general discussion, and I prefer it if comments here would be kept to what is directly relevant for this PR.",FALSE,FALSE,35,0,0,0,TRUE,TRUE,FALSE,TRUE,0,1,1
addaleax,"CI: https://ci.nodejs.org/job/node-test-commit/9143/",FALSE,FALSE,2,0,1,1,TRUE,TRUE,FALSE,TRUE,0,1,2
addaleax,"make -j4 test (UNIX), or vcbuild test (Windows) passes",FALSE,FALSE,9,0,3,3,TRUE,FALSE,FALSE,TRUE,0,1,3
addaleax,"tests and/or benchmarks are included",FALSE,FALSE,5,0,4,4,TRUE,FALSE,FALSE,TRUE,0,1,4
addaleax,"documentation is changed or added",FALSE,FALSE,5,0,5,5,TRUE,FALSE,FALSE,TRUE,0,1,5
addaleax,"commit message follows commit guidelines",FALSE,FALSE,5,0,6,6,TRUE,FALSE,FALSE,TRUE,0,1,6
addaleax,"Affected core subsystem(s)",FALSE,FALSE,3,0,7,7,TRUE,TRUE,FALSE,TRUE,0,1,7
addaleax,"util, timers",FALSE,FALSE,2,0,8,8,TRUE,FALSE,FALSE,TRUE,0,1,8
addaleax,"Original commit descriptions",FALSE,FALSE,3,0,9,9,TRUE,TRUE,FALSE,TRUE,0,1,9
addaleax,"util: add internal bindings for promise handling",FALSE,FALSE,7,0,10,10,TRUE,FALSE,FALSE,TRUE,0,1,10
addaleax,"Add methods for creating, resolving and rejecting promises using the V8 C++ API that does not require creation of extra resolve and reject functions to process.binding('util').",FALSE,FALSE,26,0,11,11,TRUE,TRUE,FALSE,TRUE,0,1,11
addaleax,"util: add util.promisify()",FALSE,FALSE,3,0,12,12,TRUE,FALSE,FALSE,TRUE,0,1,12
addaleax,"Add util.promisify(function) for creating promisified functions.",FALSE,FALSE,6,0,13,13,TRUE,TRUE,FALSE,TRUE,0,1,13
addaleax,"Fixes: nodejs/CTC#12",FALSE,FALSE,2,0,14,14,TRUE,TRUE,FALSE,TRUE,0,1,14
addaleax,"timers: add promisify support",FALSE,FALSE,4,0,15,15,TRUE,FALSE,FALSE,TRUE,0,1,15
addaleax,"Add support for util.promisify(setTimeout) and util.promisify(setImmediate) as a proof-of-concept implementation. clearTimeout() and clearImmediate() resolve the promise immediately instead of rejecting it; that might be the most opinionated choice about this.",FALSE,FALSE,30,0,16,16,TRUE,TRUE,FALSE,TRUE,0,1,16
addaleax,"/cc @chrisdickinson @benjamingr @Fishrock123 @nodejs/ctc",FALSE,FALSE,5,0,17,17,TRUE,FALSE,FALSE,TRUE,0,1,17
addaleax,"edit: CTC voting comment",FALSE,FALSE,4,0,18,18,TRUE,TRUE,FALSE,TRUE,0,1,18
addaleax,"Also, @benjamingr has a good point about the naming, quote:",FALSE,FALSE,10,1,19,0,TRUE,FALSE,FALSE,TRUE,0,2,1
addaleax,"optimally I'd hope for most people to not even be aware of what a promise is in 5 years and just use async/await seamlessly :)",FALSE,FALSE,25,1,20,1,TRUE,TRUE,FALSE,TRUE,0,2,2
addaleax,"We can bikeshed this further here, but just to get an idea how people feel, could people ðŸ‘? this comment for â€œpromisify sounds goodâ€? and ðŸ‘Ž this for â€œIâ€™d prefer awaitable or something elseâ€? (both assuming that we agree on the approach in this PR in general)?",FALSE,FALSE,47,1,21,2,TRUE,TRUE,FALSE,TRUE,0,2,3
Fishrock123,"Maybe we should split the timers bits into a second PR? They don't map well to promises since we don't have cancelables. Maybe we could plug the timers props onto the promise itself? Not sure.",FALSE,TRUE,35,2,23,1,FALSE,TRUE,TRUE,TRUE,0,3,1
Fishrock123,"I.e. clearTimeout() should probably work on whatever setTimeoutPromise() returns (a promise but you get the idea), same for Immediates.",FALSE,TRUE,19,3,25,1,FALSE,TRUE,TRUE,TRUE,0,4,1
williamkapke,"This truthy test of orig is not needed since it is guaranteed to be a function at this point",FALSE,FALSE,19,4,27,1,FALSE,TRUE,FALSE,TRUE,0,5,1
addaleax,"@williamkapke thanks for catching, done",FALSE,FALSE,5,5,28,0,TRUE,FALSE,FALSE,TRUE,0,6,1
benjamingr,"A big +1 on this. I think this could be a great first step for helping users deal with async/await in their code. There is a clear benefit over a userland implementation, and the need is prevalent.",FALSE,TRUE,37,6,29,0,FALSE,TRUE,FALSE,TRUE,0,7,1
Fishrock123,"Going to expand on my point a bit: I think this is reasonable to do for simple callback APIs but I think we should spend more* time to think about how to wrap more complex APIs such as timers, child processes, etc well.",FALSE,TRUE,43,7,31,1,FALSE,TRUE,TRUE,TRUE,0,8,1
Fishrock123,"* Might be good for an EP?",FALSE,TRUE,7,7,32,2,FALSE,TRUE,FALSE,TRUE,0,8,2
addaleax,"Maybe we should split the timers bits into a second PR?",FALSE,FALSE,11,8,33,0,TRUE,TRUE,TRUE,TRUE,0,9,1
addaleax,"If thatâ€™s what people here prefer, sure. I just thought it made sense because theyâ€™re about the only API thatâ€™s a bit icky because they donâ€™t conform to Nodeâ€™s standard callback pattern, so whenever we introduce something like util.promisify() weâ€™d probably also want to have support for promisified timers (in some way).",FALSE,FALSE,52,8,35,2,TRUE,TRUE,FALSE,TRUE,0,9,2
addaleax,"I.e. clearTimeout() should probably work on whatever setTimeoutPromise() returns (a promise but you get the idea), same for Immediates.",FALSE,FALSE,19,8,37,4,TRUE,TRUE,TRUE,TRUE,0,9,3
addaleax,"Makes sense, Iâ€™ve updated the PR with isPromise(timer) checks anyway.",FALSE,FALSE,10,8,38,5,TRUE,TRUE,FALSE,TRUE,0,9,4
benjamingr,"Going to expand on my point a bit: I think this is reasonable to do for simple callback APIs but I think we should spend more time to think about how to wrap more complex APIs such as timers, child processes, etc well.",FALSE,TRUE,43,9,41,2,FALSE,TRUE,TRUE,TRUE,0,10,1
benjamingr,"I definitely agree - we need a proper promised core at some point - but #5020 and similar attempts have stagnated and quoting myself in the original issue:",FALSE,TRUE,28,9,43,4,FALSE,TRUE,FALSE,TRUE,0,10,2
benjamingr,"The idea of util.awaitable vs a promise core is that it's hopefully a lot less objectionable, it poses a lot less controversy, it's a lot less opinionated and it means exposing a capability that users can build on and not an API.",FALSE,TRUE,42,9,45,6,FALSE,TRUE,FALSE,TRUE,0,10,3
addaleax,"I think @Fishrock123â€™s comment was about the timers stuff, not the general API here? I feel inclined to disagree that this needs an EP, thoughâ€¦",FALSE,FALSE,25,10,46,0,TRUE,TRUE,FALSE,TRUE,0,11,1
Fishrock123,"Correct. I only mean for how to wrap any APIs that are more complex than single events or callbacks and which do not wrap as well.",FALSE,TRUE,26,11,47,0,FALSE,TRUE,FALSE,TRUE,0,12,1
TimothyGu,"function isn't a legal identifier in JS, and for consistency we probably want to keep it legal.",FALSE,FALSE,17,12,49,1,FALSE,TRUE,FALSE,TRUE,0,13,1
TimothyGu," Using the util.promisify.custom symbol ?",FALSE,FALSE,4,13,50,0,FALSE,FALSE,FALSE,TRUE,0,14,1
TimothyGu,"Lower case  custom ",FALSE,FALSE,3,14,51,0,FALSE,FALSE,FALSE,TRUE,0,15,1
addaleax,"I think the uppercase variant is okay here, itâ€™s referring to a literal section title, and it matches what we do for the other two section references in this file. If you feel strongly about it Iâ€™ll change it.",FALSE,FALSE,39,15,52,0,TRUE,TRUE,FALSE,TRUE,0,16,1
TimothyGu,"You probably want to clarify setImmediate() or its promisified equivalent.",FALSE,FALSE,10,16,53,0,FALSE,FALSE,FALSE,TRUE,0,17,1
TimothyGu,"What about the prototype of orig?",FALSE,FALSE,6,18,56,1,FALSE,TRUE,FALSE,TRUE,0,19,1
addaleax,"@TimothyGu yeah â€¦ that thought occurred to me, but I basically didnâ€™t see how setting it would make sense here. If you prefer, Iâ€™ll add",FALSE,FALSE,25,19,57,0,TRUE,TRUE,FALSE,TRUE,0,20,1
TimothyGu,"Yeah I don't see how it would matter that much in real world, but having that there does seem a bit more natural to me. Up to you if you want to set it or not.",FALSE,TRUE,36,20,58,0,FALSE,TRUE,FALSE,TRUE,0,21,1
TimothyGu,"I don't think it would matter that much; it just occurred to me having the prototype being equivalent might be more natural. Up to you.",FALSE,TRUE,25,21,60,1,FALSE,TRUE,FALSE,TRUE,0,22,1
addaleax,"@TimothyGu Iâ€™ve included it for now, letâ€™s see what people think.",FALSE,FALSE,11,22,61,0,TRUE,TRUE,FALSE,TRUE,0,23,1
addaleax,"@TimothyGu Addressed most of your comments, PTAL",FALSE,FALSE,7,23,62,0,TRUE,TRUE,FALSE,TRUE,0,24,1
vkurchatkin,"This seems like a bad idea for many reasons. I think it's fine if you can't cancel promisified timeout until we have some generic cancellation mechanism.",FALSE,FALSE,26,24,64,1,FALSE,TRUE,FALSE,TRUE,0,25,1
addaleax,"This seems like a bad idea for many reasons.",FALSE,FALSE,9,25,65,0,TRUE,FALSE,FALSE,TRUE,0,26,1
addaleax,"Would you care to provide some? Otherwise this is just not helpful.",FALSE,FALSE,12,25,66,1,TRUE,TRUE,FALSE,TRUE,0,26,2
vkurchatkin,"First of all, attaching properties to native objects seems like a bad idea from performance perspective. Secondly, this implements ad hoc cancellation mechanism, while there is no spec on standards track or even community consensus. This approach suffers from the fact that it's not propagated and there it doesn't play nice with async-await.",FALSE,FALSE,53,26,69,2,FALSE,TRUE,FALSE,TRUE,0,27,1
vkurchatkin,"I think it's fine to make promisified versions not cancellable. If you use them you are most likely not going to cancel anyway.",FALSE,FALSE,23,26,71,4,FALSE,TRUE,FALSE,TRUE,0,27,2
addaleax,"First of all, attaching properties to native objects seems like a bad idea from performance perspective.",FALSE,FALSE,16,27,73,1,TRUE,TRUE,FALSE,TRUE,0,28,1
addaleax,"Thatâ€™s true, but itâ€™s opt-in, right?",FALSE,FALSE,6,27,75,3,TRUE,TRUE,FALSE,TRUE,0,28,2
addaleax,"This approach suffers from the fact that it's not propagated",FALSE,FALSE,10,27,76,4,TRUE,TRUE,FALSE,TRUE,0,28,3
addaleax,"What do you mean by propagated?",FALSE,FALSE,6,27,77,5,TRUE,TRUE,FALSE,TRUE,0,28,4
addaleax,"But yeah, I would be okay with dropping clear* support for these, at least for the time being.",FALSE,FALSE,18,27,78,6,TRUE,TRUE,FALSE,TRUE,0,28,5
vkurchatkin,"What do you mean by propagated?",FALSE,FALSE,6,28,79,0,FALSE,TRUE,FALSE,TRUE,0,29,1
vkurchatkin,"Something like this:",FALSE,FALSE,3,28,80,1,FALSE,TRUE,FALSE,TRUE,0,29,2
jasnell,"I have to agree with @vkurchatkin on this. Until there is a standard way of canceling promises, we likely shouldn't do this.",FALSE,FALSE,22,29,82,1,FALSE,TRUE,TRUE,TRUE,0,30,1
addaleax,"@vkurchatkin @jasnell Okay, Iâ€™ve dropped clearTimeout/clearImmediate support. Itâ€™s a niche feature anyway and it should be easy to readjust later if we want.",FALSE,FALSE,23,30,83,0,TRUE,TRUE,TRUE,TRUE,0,31,1
thefourtheye,"Nit: first may not be necessary here",FALSE,FALSE,7,31,84,0,FALSE,FALSE,FALSE,TRUE,0,32,1
addaleax,"Youâ€™re right. I wanted to phrase this error message in a way that makes it as unlikely as possible that changing it is semver-major, but if you prefer another wording, Iâ€™ll gladly change it. ðŸ˜„",FALSE,FALSE,35,32,85,0,TRUE,TRUE,FALSE,TRUE,0,33,1
thefourtheye,"I was thinking maybe we can just drop first. When I read the error message, my mind understood that as there are more than one argument. Not a big deal though.",FALSE,FALSE,31,33,87,1,FALSE,TRUE,FALSE,TRUE,0,34,1
thefourtheye,"There are few cases where we pass more than one value like in fs.read",FALSE,FALSE,14,34,88,0,FALSE,FALSE,FALSE,TRUE,0,35,1
addaleax,"So â€¦ if you like, I can check for those APIs and add custom code for them in this PR? I think that makes sense but maybe not everybody is comfortable with yet more changes in hereâ€¦",FALSE,FALSE,37,35,90,1,TRUE,TRUE,FALSE,TRUE,0,36,1
thefourtheye,"We can use rest operator with data and with an if condition this can be fixed, right? Only thing is the resolved value will be an array for these special cases.",FALSE,FALSE,31,36,92,1,FALSE,TRUE,FALSE,TRUE,0,37,1
addaleax,"@thefourtheye We have about 6 top-level functions doing that, Iâ€™ve taken a stab at addressing them in a clean way in this PR (see the most recent 3 commits)â€¦ please take a look :)",FALSE,FALSE,34,37,94,1,TRUE,TRUE,FALSE,TRUE,0,38,1
TimothyGu,"If the original immediate was a promise not coming from setImmediate(), immediate should be undefined here, and this might crash. Not sure if we want that.",FALSE,TRUE,26,38,96,1,FALSE,TRUE,TRUE,TRUE,0,39,1
addaleax,"This code doesnâ€™t have any typechecks right now anyway, you can just pass in anything and hope it doesnâ€™t go up in flames.",FALSE,FALSE,23,39,98,1,TRUE,TRUE,FALSE,TRUE,0,40,1
TimothyGu,"I don't think it would matter that much; it just occurred to me having the prototype being equivalent might be more natural. Up to you.",FALSE,TRUE,25,40,99,0,FALSE,TRUE,FALSE,TRUE,0,41,1
TimothyGu,"I'd make sure this doesn't decrease the performance of getting fn's properties; if in doubt, an if (Object.getPrototypeOf(fn) !== Object.getPrototypeOf(orig)) might be good.",FALSE,TRUE,23,41,100,0,FALSE,TRUE,FALSE,TRUE,0,42,1
addaleax,"V8 implements setPrototypeOf as a no-op if they are already equal, Iâ€™ve checked that in the past to be sure. ðŸ˜„",FALSE,FALSE,21,42,101,0,TRUE,TRUE,FALSE,TRUE,0,43,1
thefourtheye,"Promises are idempotent right? Should we really do this?",FALSE,TRUE,9,43,103,1,FALSE,TRUE,FALSE,TRUE,0,44,1
benjamingr,"It's to check that the promise is pending at that point. It might not be necessary but not because of idempotence.",FALSE,TRUE,21,44,105,1,FALSE,TRUE,FALSE,TRUE,0,45,1
addaleax,"Hm, maybe it is necessary to always check for thatâ€¦ some really weird userland functions could schedule the callback to run and then throw after that. (And using this code would actually change the Promise state.)",FALSE,FALSE,36,45,106,0,TRUE,TRUE,FALSE,TRUE,0,46,1
addaleax,"Iâ€™ve updated this to return as a no-op when the promise is not pending.",FALSE,FALSE,14,46,107,0,TRUE,FALSE,FALSE,TRUE,0,47,1
thefourtheye,"We may need another condition here for callbacks which don't return anything interesting, like rmdir",FALSE,TRUE,15,47,109,1,FALSE,TRUE,FALSE,TRUE,0,48,1
addaleax,"@thefourtheye thanks for catching, done",FALSE,FALSE,5,48,110,0,TRUE,FALSE,FALSE,TRUE,0,49,1
thefourtheye,"There is only one case where this will fail, fs.exists. But we don't have to worry much about it anyway I guess, as it is deprecated.",FALSE,TRUE,26,49,111,0,FALSE,TRUE,FALSE,TRUE,0,50,1
addaleax,"@benjamingr @TimothyGu Itâ€™s nice to see support so soon, but you may want to give the changes here based on @thefourtheyeâ€™s comments a look, I donâ€™t want to just assume they LGTY too",FALSE,FALSE,33,50,112,0,TRUE,TRUE,FALSE,TRUE,0,51,1
addaleax,"edit: new CI: https://ci.nodejs.org/job/node-test-commit/9146/https://ci.nodejs.org/job/node-test-commit/9147/https://ci.nodejs.org/job/node-test-commit/9148/ (green ðŸŽ‰)",FALSE,FALSE,6,50,113,1,TRUE,TRUE,FALSE,TRUE,0,51,2
vkurchatkin,"One more thing to consider: util.promisify won't play nice with typecheckers, such as Flow and Typescript. For this reason I personally would prefer to have promisifed versions of built-in modules out of the box.",FALSE,TRUE,34,51,115,1,FALSE,TRUE,FALSE,TRUE,0,52,1
benjamingr,"@vkurchatkin mind elaborating? Since TypeScript 2.2 and keyof I've been able to get perfectly decent typings with TypeScript - you can specify the type as  takes a function that takes N arguments and a node callback and return a function that takes N arguments and returns a promise .",FALSE,TRUE,48,52,117,1,FALSE,TRUE,FALSE,TRUE,0,53,1
vkurchatkin,"@benjamingr I guess you could declare overloads for some sufficient number of arguments (in both Flow and TS), but it's not so nice and also won't work with custom promisified implementations.",FALSE,TRUE,31,53,119,1,FALSE,TRUE,FALSE,TRUE,0,54,1
benjamingr,"@addaleax I'm still LGTM but would rather have this split into two PRs - one just addzing promisify (as awaitable) without touching any core methods and one adding the rest of the API",FALSE,TRUE,33,54,120,0,FALSE,TRUE,FALSE,TRUE,0,55,1
addaleax,"@benjamingr So â€¦ Iâ€™ve thought about this a bit, and Iâ€™m not sure the advantages in splitting this up are large enough to me; we can obviously land the changes for the built-in modules separately, but they should definitely be released together. And if there is non-trivial feedback on the timers/child_process/fs/dns changes, Iâ€™d say thereâ€™s a good chance we would take a look at util.promisify itself to see if changes in it would help address that feedback.",FALSE,TRUE,77,55,121,0,TRUE,TRUE,TRUE,TRUE,0,56,1
thefourtheye,"@addaleax As far as I know the current implementation will fail only for fs.exists. Since its usage is discouraged, we don't have to spend much time on it I think.",FALSE,TRUE,30,56,122,0,FALSE,TRUE,FALSE,TRUE,0,57,1
addaleax,"@thefourtheye Yeah, I think itâ€™s okay to leave fs.exists alone. Itâ€™s more interesting for e.g. the 2 child_process methods which give you a (err, stdout, stderr) callback â€“ that would be weird if they didnâ€™t have custom implementations.",FALSE,TRUE,38,57,123,0,TRUE,TRUE,FALSE,TRUE,0,58,1
TimothyGu,"The logic should probably prefer argumentNames !== undefined over values.length === 1, since if for some reason the second argument (like stderr) is undefined we would still want to resolve an object.",FALSE,TRUE,32,58,125,1,FALSE,TRUE,TRUE,TRUE,0,59,1
addaleax,"So, there is one case where this currently matters, and that is dns.lookup, which has different callback signatures depending on whether the all option is set to true. That would need some special handling if the cases here get switched. I could do it now, but Iâ€™ve kept argumentNames internal in order to make sure we can keep code noise to a minimum and tweak this logic at a later point if we want/need to.",FALSE,TRUE,75,59,127,1,TRUE,TRUE,FALSE,TRUE,0,60,1
BridgeAR,"This should be setTimeoutPromise.",FALSE,FALSE,4,60,128,0,FALSE,FALSE,TRUE,TRUE,0,61,1
addaleax,"@BridgeAR thanks for catching, fixed!",FALSE,TRUE,5,61,129,0,TRUE,FALSE,FALSE,TRUE,0,62,1
misterdjules,"I have the same concerns with this PR that I had with #5020 (see #5020 (comment), some parts of #5084 and nodejs/post-mortem#16, among other discussions).",FALSE,FALSE,25,62,130,0,FALSE,TRUE,FALSE,TRUE,0,63,1
misterdjules,"The TL;DR is: it seems that, by catching all uncaught exceptions by default,  promisified  functions would present an error handling model that is fundamentally different than the one currently presented by node's core APIs.",FALSE,FALSE,34,62,132,2,FALSE,TRUE,FALSE,TRUE,0,63,2
misterdjules,"The error handling model of promisified functions seems like it would not be compatible with some of the best practices regarding error handling that have been established in the past. Post-mortem debugging is one use case of this error handling model that would be significantly impacted.",FALSE,FALSE,46,62,134,4,FALSE,TRUE,FALSE,TRUE,0,63,3
misterdjules,"As a result, I would be -1 on these changes. /ccing the @nodejs/post-mortem team in case they have additional feedback.",FALSE,FALSE,20,62,135,5,FALSE,TRUE,FALSE,TRUE,0,63,4
misterdjules,"On a different topic, It seems that promises are still not hooked with domains, is that correct?  It's a much lesser concern as it seems the facilities to support this have been introduced in V8 and IIRC are available from V8 5.7, so I would think it would be possible to fix this specific issue.",FALSE,FALSE,56,62,137,7,FALSE,TRUE,FALSE,TRUE,0,63,5
addaleax,"The TL;DR is: it seems that, by catching all uncaught exceptions by default,  promisified  functions would present an error handling model that is fundamentally different than the one currently presented by node's core APIs.",FALSE,TRUE,34,63,139,1,TRUE,TRUE,FALSE,TRUE,0,64,1
addaleax,"Yes, but as has been pointed out elsewhere, Promises have a different error handling model by design. I agree with a lot of what you say, but itâ€™s just a fact that Promises are seeing widespread adoption, whether we explicitly support them in core or not (that we ship async/await now might be much more of a factor than this PR could be), so I personally donâ€™t think itâ€™s sensible to link this PR to the issues with debugging.",FALSE,TRUE,79,63,141,3,TRUE,TRUE,FALSE,TRUE,0,64,2
addaleax,"(I appreciate you speaking up, and if you are voicing formal opposition, then this is the right place, but if you want to continue this discussion can we please move it to nodejs/CTC#12 as requested above?)",FALSE,TRUE,36,63,142,4,TRUE,FALSE,FALSE,TRUE,0,64,3
addaleax,"It seems that promises are still not hooked with domains, is that correct? It's a much lesser concern as it seems the facilities to support this have been introduced in V8 and IIRC are available from V8 5.7, so I would think it would be possible to fix this specific issue.",FALSE,TRUE,51,63,144,6,TRUE,TRUE,FALSE,TRUE,0,64,4
addaleax,"Yes, Promises are not wired up with domains and V8 5.7 has the promise hooks that we want. Maybe it would be a good idea to wire that up with domains, but just icymi, async_hooks are around the corner (#11883). (edit: to clarify, they donâ€™t have promise hooks yet either, but unlike domains, there are concrete plans to implement that)",FALSE,TRUE,60,63,146,8,TRUE,TRUE,FALSE,TRUE,0,64,5
jasnell,"Random thought: could we not add an optional options object to util.promisify() that would allow the error handling to be configurable?",FALSE,TRUE,21,64,148,1,FALSE,TRUE,FALSE,TRUE,0,65,1
addaleax,"@jasnell Sure, we could do that. Iâ€™d maybe call it something like synchronousReject or something (because otherwise this might lead to confusion with uncaught exceptions in the process.on('uncaughtException') sense). Does that sound okay?",FALSE,TRUE,33,65,150,1,TRUE,TRUE,FALSE,TRUE,0,66,1
jasnell,"Works for me!",FALSE,TRUE,3,66,151,0,FALSE,FALSE,FALSE,TRUE,0,67,1
addaleax,"@jasnell Thinking about it â€¦ are you sure that makes much sense, though? For code inside a promise chain there wonâ€™t be much of a difference, and it would mean that if core moves towards providing special promisified versions for functions (which might be useful to get performance more comparable to what callbacks provide), it would possibly have to maintain multiple such variantsâ€¦",FALSE,TRUE,63,67,153,1,TRUE,TRUE,FALSE,TRUE,0,68,1
jasnell,"yeah, good point. Separating out the error handling so that it can be handled more consistently across all promises, not just those created using util.promisify() is a good thing.",FALSE,TRUE,29,68,155,1,FALSE,TRUE,FALSE,TRUE,0,69,1
misterdjules,"Yes, but as has been pointed out elsewhere, Promises have a different error handling model by design.",FALSE,FALSE,17,69,158,2,FALSE,TRUE,FALSE,TRUE,0,70,1
misterdjules,"I agree, and what I tried to convey is that the design of Promises presents an error handling model that is not compatible with some existing best practices used by a significant part of node users. I just wanted to be very specific and point to the changes in this PR that implement this part of the Promises design to avoid any confusion.",FALSE,FALSE,63,69,159,3,FALSE,TRUE,FALSE,TRUE,0,70,2
misterdjules,"I would add that the fact that the Promises error handling model was designed the way it is intentionally doesn't make it more suitable for some use cases.",FALSE,FALSE,28,69,161,5,FALSE,TRUE,FALSE,TRUE,0,70,3
misterdjules,"itâ€™s just a fact that Promises are seeing widespread adoption, whether we explicitly support them in core or not (that we ship async/await now might be much more of a factor than this PR could be), so I personally donâ€™t think itâ€™s sensible to link this PR to the issues with debugging.",FALSE,FALSE,52,69,162,6,FALSE,TRUE,FALSE,TRUE,0,70,4
misterdjules,"I don't understand that part of your response. Do you mean that the popularity of promises outweighs the issues they present with regards to existing best practices for error handling, including those that allow for using post-mortem debugging techniques?",FALSE,FALSE,39,69,163,7,FALSE,TRUE,FALSE,TRUE,0,70,5
misterdjules,"(I appreciate you speaking up, and if you are voicing formal opposition, then this is the right place, but if you want to continue this discussion can we please move it to nodejs/CTC#12 as requested above?)",FALSE,FALSE,36,69,164,8,FALSE,FALSE,FALSE,TRUE,0,70,6
misterdjules,"I had seen that request in the original post, but I wanted to voice a formal opposition. Now that I've done that though, I'm willing to continue the conversation wherever you'd like to see it happen.",FALSE,FALSE,36,69,165,9,FALSE,TRUE,FALSE,TRUE,0,70,7
misterdjules,"Yes, Promises are not wired up with domains and V8 5.7 has the promise hooks that we want. Maybe it would be a good idea to wire that up with domains, but just icymi, async_hooks are around the corner (#11883). (edit: to clarify, they donâ€™t have promise hooks yet either, but unlike domains, there are concrete plans to implement that)",FALSE,FALSE,60,69,167,11,FALSE,TRUE,FALSE,TRUE,0,70,8
misterdjules,"I would be concerned that current users of domains, even though domains are deprecated, would be increasingly hit by issues such as nodejs/node-v0.x-archive#8648 without a smooth migration path. Asking users to move to using async hooks seems like it could be highly disruptive for them. So I would think that if hooking promises to domain is not a large undertaking, it would be a good idea to at least investigate what it would take. I'm volunteering to do this work if that would help.",FALSE,FALSE,84,69,169,13,FALSE,TRUE,FALSE,TRUE,0,70,9
MadaraUchiha,"I'm currently looking into adding as many tests as possible from Bluebird, one of those is the following:",FALSE,FALSE,18,70,170,0,FALSE,TRUE,FALSE,TRUE,0,71,1
MadaraUchiha,"Do you think it would be beneficial to keep track of promisified functions and not promisify them again? cc @benjamingr #goodnessSquad",FALSE,FALSE,21,70,172,2,FALSE,TRUE,FALSE,TRUE,0,71,2
addaleax,"@MadaraUchiha sure, makes sense. done!",FALSE,TRUE,5,71,173,0,TRUE,FALSE,FALSE,TRUE,0,72,1
giltayar,"While writing tests for kCustomPromisifyArgsSymbol, I  found out  that this symbol is not exported via the promisify function, like promisify.custom is, but is rather exported only in internal/util.",FALSE,FALSE,28,72,174,0,FALSE,TRUE,FALSE,TRUE,0,73,1
giltayar,"This looks like an explicit design decision, but I was wondering why the decision to do this. I can definitely see people wanting to use it, just like they would want to use promisify.custom.",FALSE,FALSE,34,72,175,1,FALSE,TRUE,FALSE,FALSE,1,73,2
giltayar,"Also, is there a way to access internal/util from the tests, so that I can test it explicitly? (and not like today, where it is tested implicitly via the test for promisify(exec)",FALSE,FALSE,32,72,176,2,FALSE,TRUE,FALSE,TRUE,0,73,3
addaleax,"This looks like an explicit design decision, but I was wondering why the decision to do this. I can definitely see people wanting to use it, just like they would want to use promisify.custom.",FALSE,TRUE,34,73,179,1,TRUE,TRUE,FALSE,TRUE,0,74,1
addaleax,"Mostly, see this discussion: #12442 (comment) â€“ In short, emulating it is already kinda doable with promisify.custom, and it might be nice to have it available internally for more flexibility, at least for now. :)",FALSE,TRUE,35,73,181,3,TRUE,TRUE,FALSE,TRUE,0,74,2
addaleax,"Also, is there a way to access internal/util from the tests, so that I can test it explicitly? (and not like today, where it is tested implicitly via the test for promisify(exec)",FALSE,TRUE,32,73,182,4,TRUE,TRUE,FALSE,TRUE,0,74,3
addaleax,"Is adding // Flags: --expose-internals on the first line in the test file what you are looking for? :) It allows you to require('internal/â€¦').",FALSE,TRUE,24,73,183,5,TRUE,TRUE,FALSE,TRUE,0,74,4
TimothyGu,"What happens in case of the following:",FALSE,TRUE,7,75,185,0,FALSE,FALSE,FALSE,TRUE,0,76,1
TimothyGu,"Seems like a good idea to define kCustomPromisifiedSymbol on the returned function even when there is an existing orig[kCustomPromisifiedSymbol].",FALSE,TRUE,19,75,187,2,FALSE,TRUE,FALSE,TRUE,0,76,2
addaleax,"@TimothyGu thanks for pointing out, addressed both comments :)",FALSE,TRUE,9,76,188,0,TRUE,FALSE,FALSE,TRUE,0,77,1
jasnell,"What happens if a Promise that is not a promisified-variant of setImmediate()?",FALSE,TRUE,12,77,189,0,FALSE,TRUE,FALSE,TRUE,0,78,1
benjamingr,"On it.",FALSE,TRUE,2,78,190,0,FALSE,FALSE,FALSE,TRUE,0,79,1
jasnell,"s/is a/is an",FALSE,TRUE,3,79,191,0,FALSE,FALSE,FALSE,TRUE,0,80,1
jasnell,"I would move this up further and show an example.",FALSE,TRUE,10,80,192,0,FALSE,FALSE,FALSE,TRUE,0,81,1
addaleax,"I think this is a situation thatâ€™s rare enough not to mention it at the top. Iâ€™ve added an example here, though.",FALSE,TRUE,22,81,193,0,TRUE,TRUE,FALSE,TRUE,0,82,1
jasnell,"I have to agree with @vkurchatkin on this. Until there is a standard way of canceling promises, we likely shouldn't do this.",FALSE,TRUE,22,82,194,0,FALSE,TRUE,TRUE,TRUE,0,83,1
jasnell,">>>yunong, ðŸ‘?4",FALSE,TRUE,2,82,195,1,FALSE,FALSE,FALSE,TRUE,0,83,2
jasnell,"itâ€™s just a fact that Promises are seeing widespread adoption, whether we explicitly support them in core or not (that we ship async/await now might be much more of a factor than this PR could be),so I personally donâ€™t think itâ€™s sensible to link this PR to the issues with debugging.",FALSE,TRUE,51,82,197,3,FALSE,TRUE,FALSE,TRUE,0,83,3
jasnell,"I don't understand that part of your response. Do you mean that the popularity of promises outweighs the issues they present with regards to existing best practices for error handling, including those that allow for using post-mortem debugging techniques?",FALSE,TRUE,39,82,199,5,FALSE,TRUE,FALSE,TRUE,0,83,4
jasnell,"I emphatically agree with @misterdjules here. Are we willing to make the trade-off of safe error handling (and by association reliability and debuggability) versus popularity in Node core?",FALSE,TRUE,28,82,201,7,FALSE,TRUE,FALSE,TRUE,0,83,5
jasnell,"We run node at scale in production here at Netflix, where reliability and debuggability are of the utmost importance to our customers and us. I would strongly caution against landing this PR and encourage dialogue with folks (Netflix, Pinterest, Uber, Twitter, Uber, Joyent, among others) who are running Node at scale to gather feedback.",FALSE,TRUE,54,82,202,8,FALSE,TRUE,FALSE,TRUE,0,83,6
jasnell,"This PR means that we're unable to safely rely on the existing error handling semantics, namely not swallowing errors by default or affecting post-mortem debugging. Again, I can't stress how critical the existing error handling semantics are regarding operating our Node stack in the critical Netflix streaming path at scale. It's imperative to us that the Node runtime continues to work with the existing error handling best practices. After all, we're relying on Node in some of our most critical systems here at Netflix, where reliability and debuggability are our top priority.",FALSE,TRUE,92,82,204,10,FALSE,TRUE,FALSE,TRUE,0,83,7
addaleax,"@yunong I appreciate you speaking up on this matter, but Iâ€™ve replied to Julienâ€™s comment above as well at yours at nodejs/CTC#12 (comment). As noted above, thatâ€™s a better place for more general concerns about improved Promise support in Node core.",FALSE,TRUE,41,83,205,0,TRUE,TRUE,FALSE,TRUE,0,84,1
addaleax,"(@jasnell Iâ€™ll get to addressing your review later today, probably.)",FALSE,TRUE,10,83,206,1,TRUE,TRUE,FALSE,TRUE,0,84,2
addaleax,"@jasnell Updated, PTAL",FALSE,TRUE,3,84,207,0,TRUE,TRUE,FALSE,TRUE,0,85,1
addaleax,"CI: https://ci.nodejs.org/job/node-test-commit/9234/",FALSE,TRUE,2,84,208,1,TRUE,TRUE,FALSE,TRUE,0,85,2
thefourtheye,"Single quotes",FALSE,TRUE,2,85,209,0,FALSE,FALSE,FALSE,TRUE,0,86,1
addaleax,"@thefourtheye thanks, fixed!",FALSE,TRUE,3,86,210,0,TRUE,FALSE,FALSE,TRUE,0,87,1
thefourtheye,"format typo",FALSE,TRUE,2,87,211,0,FALSE,FALSE,FALSE,TRUE,0,88,1
jasnell,"might be worthwhile adding this as a utility in common.js ... e.g.",FALSE,TRUE,12,88,212,0,FALSE,FALSE,FALSE,TRUE,0,89,1
addaleax,"@jasnell done!",FALSE,TRUE,2,89,213,0,TRUE,FALSE,FALSE,TRUE,0,90,1
ljharb,"This seems like it's observably installing something onto the original function (symbols are fully public). If so, could this use a WeakMap as a cache instead?",FALSE,FALSE,26,90,215,1,FALSE,TRUE,FALSE,TRUE,0,91,1
addaleax,"This seems like it's observably installing something onto the original function",FALSE,TRUE,11,91,216,0,TRUE,TRUE,FALSE,TRUE,0,92,1
addaleax,"Onto an user-supplied promisified version of the original function, yes. I know this seems a bit odd, but it makes sense for consistency with the common case of not having a custom functionâ€¦",FALSE,TRUE,33,91,218,2,TRUE,TRUE,FALSE,TRUE,0,92,2
addaleax,"symbols are fully public",FALSE,TRUE,4,91,219,3,TRUE,FALSE,FALSE,TRUE,0,92,3
addaleax,"I know that :)",FALSE,TRUE,4,91,220,4,TRUE,TRUE,FALSE,TRUE,0,92,4
addaleax,"If so, could this use a WeakMap as a cache instead?",FALSE,TRUE,11,91,221,5,TRUE,TRUE,FALSE,TRUE,0,92,5
addaleax,"It could, but are you worried about a performance impact, or visibility of the symbol? If itâ€™s the former, Iâ€™m not sure thatâ€™s relevant, it would be odd for users to call their own function that they made specifically for util.promisify(); if itâ€™s the latterâ€¦ itâ€™s a symbol meant for public use, not to hide something.",FALSE,TRUE,56,91,223,7,TRUE,TRUE,FALSE,TRUE,0,92,6
ljharb,"I'm not worried about performance - just visibility. String(Object.getOwnPropertySymbols(util.promisify(() => {}))[0])) === 'Symbol(util.promisify.custom) would become part of the API, or at least something to debate about changing later; Code relying on Object.getOwnPropertySymbols(func) could suddenly break if someone calls util.promisify on it (which means it's susceptible to any mutation, but that doesn't mean node core should be the cause of it); if you later want to cache more information than the function itself, the implementation of this caching suddenly could become semver-major; const sym = Object.getOwnPropertySymbols(util.promisify(() => {}))[0]; func[sym] = notAFunction; would mean that util.promisify(func) would not reliably produce a function that returns a promise (which absolutely could break code)â€¦",FALSE,FALSE,109,92,225,1,FALSE,TRUE,TRUE,TRUE,0,93,1
ljharb,"Is the purpose of the symbol so that users don't need to call util.promisify later, or is the purpose caching? If the former, what's the utility? If the latter, why not use an implementation detail that's invisible to consumers?",FALSE,FALSE,39,92,227,3,FALSE,TRUE,FALSE,TRUE,0,93,2
ljharb,"Maybe I'm totally misunderstanding and this is a mechanism for overriding the promisified version of a function - in which case, how is the symbol globally exposed to users?",FALSE,FALSE,29,93,228,0,FALSE,TRUE,FALSE,TRUE,0,94,1
ljharb,"ok, re-reading i see util.promisify.custom - so it appears that this is an intentional custom API, not primarily a caching mechanism. In that case, should this not assert that the value is indeed a function, and either throw or ignore it if it's not?",FALSE,FALSE,44,94,230,1,FALSE,TRUE,TRUE,TRUE,0,95,1
addaleax,"In that case, should this not assert that the value is indeed a function",FALSE,TRUE,14,95,231,0,TRUE,TRUE,TRUE,TRUE,0,96,1
addaleax,"It probably should, yes. Iâ€™ve updated the PR with that. :)",FALSE,TRUE,11,95,232,1,TRUE,TRUE,TRUE,TRUE,0,96,2
littledan,"You could use the V8 API to get a private symbol here using Private::New if not adding public properties is important here.",FALSE,FALSE,22,96,234,1,FALSE,TRUE,FALSE,TRUE,0,97,1
addaleax,"@littledan I know, but thanks for the pointer. This is supposed to be a public symbol, though :)",FALSE,TRUE,18,97,235,0,TRUE,TRUE,FALSE,TRUE,0,98,1
benjamingr,"@ljharb anything else pending you've asked for or are you LGTM?",FALSE,TRUE,11,98,236,0,FALSE,TRUE,FALSE,TRUE,0,99,1
ljharb,"Just the isAsyncFunction question - I'm not sure why a function that already returns a promise should ever be promisified, explicit symbol or not.",FALSE,TRUE,24,99,238,1,FALSE,TRUE,TRUE,TRUE,0,100,1
addaleax,"@thefourtheye Mind taking another look? I fixed your typo but Iâ€™m not sure whether you had more review comments and Github just lost them or you deleted them or Iâ€™m just imagining thingsâ€¦",FALSE,TRUE,33,100,239,0,TRUE,TRUE,FALSE,TRUE,0,101,1
ljharb,"Why would an async function need a promisified version of itself, such that this condition goes after checking the symbol?",FALSE,TRUE,20,101,241,1,FALSE,TRUE,FALSE,TRUE,0,102,1
benjamingr,"It doesn't - that'a why identity is returned.",FALSE,TRUE,8,102,243,1,FALSE,TRUE,FALSE,TRUE,0,103,1
ljharb,"The current code reads from the custom symbol and returns that, before checking if orig is an async function - i'm suggesting moving that check higher up so that async functions can't have custom promisified versions.",FALSE,TRUE,36,103,244,0,FALSE,FALSE,FALSE,TRUE,0,104,1
addaleax,"I donâ€™t have too strong feelings, but tbh, if a user explicitly asks for a certain behaviour, I think that should be what they get",FALSE,TRUE,25,104,245,0,TRUE,TRUE,TRUE,TRUE,0,105,1
ljharb,"I think that the more likely scenario is that the user will unintentionally ask for that behavior without realizing that it's unnecessary; the alternative is that having a custom function on an async function could throw for now, and if use cases present themselves, the throwing could be removed.",FALSE,TRUE,49,105,247,1,FALSE,TRUE,FALSE,TRUE,0,106,1
benjamingr,"I don't have strong feelings, I'm fine with just 'promisifying' async functions.",FALSE,TRUE,12,106,248,0,FALSE,TRUE,FALSE,TRUE,0,107,1
benjamingr,"Come to think of it, I don't think we should special-case async functions since functions can take callbacks and return promises too and promisify should be consistent on those.",FALSE,TRUE,29,107,250,1,FALSE,TRUE,TRUE,TRUE,0,108,1
benjamingr,"I'd expect util.promisify to return a function that returns a promise for the callback'd value and not the originally returned promised.",FALSE,TRUE,21,107,251,2,FALSE,TRUE,FALSE,TRUE,0,108,2
addaleax,"@benjamingr hmm, Iâ€™ll think about it for a bit. I see the point in your example, but it doesnâ€™t feel quite right to pass an extra cb in that caseâ€¦",FALSE,TRUE,30,108,252,0,TRUE,TRUE,FALSE,TRUE,0,109,1
addaleax,"(Also, util.promisify would be exactly for that case, to enable users to avoid using the callback API ;))",FALSE,TRUE,18,108,253,1,TRUE,TRUE,FALSE,TRUE,0,109,2
not-an-aardvark,"In my opinion, it would be confusing to have special behavior for async functions. As a user, I would expect to be able to convert any Promise-returning function to an analogous async function without worrying about behavior changes. This is usually a safe assumption because async functions are indistinguishable from regular functions*, but it won't hold if util.promisify has  magic  behavior and treats async functions differently.",FALSE,FALSE,66,109,255,1,FALSE,TRUE,FALSE,TRUE,0,110,1
not-an-aardvark,"My intuitive model of this function is that it should behave like this (with better performance):",FALSE,FALSE,16,109,256,2,FALSE,TRUE,TRUE,TRUE,0,110,2
not-an-aardvark,"This is a relatively simple spec and is easy to understand. I think util.promisify will get more confusing the more it deviates from this.",FALSE,FALSE,24,109,257,3,FALSE,TRUE,FALSE,TRUE,0,110,3
not-an-aardvark,"*Aside from rarely-used operations such as func.toString() and func.constructor",FALSE,FALSE,9,109,258,4,FALSE,FALSE,FALSE,TRUE,0,110,4
ljharb,"@not-an-aardvark That approach would make sense as well, but the existence of a symbol override means that your expectation already doesn't hold. Similarly, if you have a callback-taking function with an overridden promisification, and you convert it to an async function, then when would you need an overridden promisification on that async function?",FALSE,TRUE,53,110,260,1,FALSE,TRUE,FALSE,TRUE,0,111,1
not-an-aardvark,"That approach would make sense as well, but the existence of a symbol override means that your expectation already doesn't hold.",FALSE,TRUE,21,111,262,1,FALSE,TRUE,FALSE,TRUE,0,112,1
not-an-aardvark,"Fair enough, but that's a one-line addition, and I would say the API is still easy to understand with that change because it's still easily polyfillable.",FALSE,TRUE,26,111,263,2,FALSE,TRUE,FALSE,TRUE,0,112,2
not-an-aardvark,"Similarly, if you have a callback-taking function with an overridden promisification, and you convert it to an async function, then when would you need an overridden promisification on that async function?",FALSE,TRUE,31,111,264,3,FALSE,TRUE,FALSE,TRUE,0,112,3
not-an-aardvark,"Note that this doesn't just apply to overridden promisifications -- it's applicable for any function that returns a Promise and also accepts a callback, where the Promise and the callback don't always resolve to the same value..",FALSE,TRUE,37,111,266,5,FALSE,TRUE,FALSE,TRUE,0,112,4
not-an-aardvark,"I'm not trying to argue that making a function behave like this is good design. The problem is that we're changing behavior based on whether the function was created using the async function syntax, which is an implementation detail of the function and not part of its public API. If we changed behavior based on whether the function returned a Promise, then it wouldn't be a problem (although that could be difficult to determine without calling the function beforehand).",FALSE,TRUE,79,111,268,7,FALSE,TRUE,FALSE,TRUE,0,112,5
not-an-aardvark,"As an example: it's common for people to write async functions, and use Babel to transpile the code to an identically-behaving function that does not use async/await syntax. This works because consumers don't care whether a function is an async function -- they only care that it returns a Promise and never throws synchronously. With the current util.promisify implementation, this would not be the case -- it would be impossible for Babel to accurately transpile async functions because we would be making decisions based on the syntax that the function was created with. As a result, users could end up with confusing bugs where some code works with Babel, but fails when Babel is removed.",FALSE,TRUE,115,111,269,8,FALSE,TRUE,FALSE,TRUE,0,112,6
not-an-aardvark,">>>ljharb, ðŸ‘?1",FALSE,TRUE,2,111,270,9,FALSE,FALSE,FALSE,TRUE,0,112,7
not-an-aardvark,"That's a very good point, and a strong argument to remove the check altogether. @addaleax, thoughts?",FALSE,TRUE,16,111,271,10,FALSE,TRUE,FALSE,TRUE,0,112,8
addaleax,"@not-an-aardvark @ljharb Ack, that is a very good point. Iâ€™ve removed that check.",FALSE,TRUE,13,112,272,0,TRUE,TRUE,FALSE,TRUE,0,113,1
benjamingr,"@thefourtheye @evanlucas @vkurchatkin any other reservations from the review? (From what I see all comments were fixed)",FALSE,TRUE,17,113,273,0,FALSE,TRUE,FALSE,TRUE,0,114,1
benjamingr,"@littledan are you fine with deferring #12442 (comment) to a later PR? Do the changes look fine to you?",FALSE,TRUE,19,113,274,1,FALSE,TRUE,FALSE,TRUE,0,114,2
benjamingr,">>>littledan, ðŸ‘?1",FALSE,TRUE,2,113,275,2,FALSE,FALSE,FALSE,TRUE,0,114,3
benjamingr,"@benjamingr Yes, completely fine with deferring further optimizations. I don't see any particular problem with this PR, and it's great to hear that you've measured performance improvements.",FALSE,TRUE,27,113,276,3,FALSE,TRUE,FALSE,TRUE,0,114,4
addaleax,"CI: https://ci.nodejs.org/job/node-test-commit/9370/",FALSE,TRUE,2,114,277,0,TRUE,FALSE,FALSE,TRUE,0,115,1
Daniel15,"Are there any guidelines for what should go in the util module vs what should go elsewhere? it seems like there's a whole bunch of random stuff in util. I wonder whether it's worth making a separate cohesive module for async-related utilities (like promise-util or async-util or something).",FALSE,FALSE,48,115,279,1,FALSE,TRUE,TRUE,TRUE,0,116,1
benjamingr,"@Daniel15 the discussion about the actual feature in the language is at nodejs/CTC#12 - this thread is for the PR changes themselves.",FALSE,TRUE,22,116,280,0,FALSE,TRUE,FALSE,TRUE,0,117,1
benjamingr,">>>Daniel15, ðŸ‘?1",FALSE,TRUE,2,116,281,1,FALSE,FALSE,FALSE,TRUE,0,117,2
benjamingr,"Thanks @benjamingr, I'll cross-post there.",FALSE,TRUE,5,116,282,2,FALSE,TRUE,FALSE,TRUE,0,117,3
not-an-aardvark,"I think the implicit behavior switch here might be confusing. Bluebird originally had this behavior in its promisify function, but it was changed later in a major release because it caused compatibility issues when an additional argument was added to a callback. The 3.0 promisify function has an explicit option for converting to an array.",FALSE,TRUE,55,117,284,1,FALSE,TRUE,FALSE,TRUE,0,118,1
not-an-aardvark,"I think it would be better to always use the first value in the callback (possibly with an opt-in for returning an array, like Bluebird has) rather than sometimes returning an array and sometimes returning a single value.",FALSE,TRUE,38,117,286,3,FALSE,TRUE,FALSE,TRUE,0,118,2
SimenB,"I think it would be better to always use the first value in the callback (possibly with an opt-in for returning an array, like Bluebird has) rather than sometimes returning an array and sometimes returning a single value.",FALSE,FALSE,38,118,288,1,FALSE,TRUE,FALSE,TRUE,0,119,1
SimenB,"This makes sense. If nothing else, with the current implementation, every callback-function deciding to resolve with an extra argument is a breaking change for everybody who's promisified that function, which I'd guess would get into a lot of minor updates and not a major.",FALSE,FALSE,44,118,289,2,FALSE,TRUE,FALSE,TRUE,0,119,2
SimenB,"FWIW, I came across a discussion on this sort of thing on the google cloud project: GoogleCloudPlatform/google-cloud-node#2167 (comment)",FALSE,FALSE,18,118,290,3,FALSE,TRUE,FALSE,TRUE,0,119,3
SimenB,"EDIT: I should read better, my exact argument was highlighted already...",FALSE,FALSE,11,118,291,4,FALSE,TRUE,TRUE,TRUE,0,119,4
benjamingr,"@not-an-aardvark I don't feel strongly about it and to be honest I'm not that sure why it was changed (see the discussion in the thread you linked to). I don't think any of us felt strongly about it then and I don't think we do now.",FALSE,TRUE,46,119,292,0,FALSE,TRUE,FALSE,TRUE,0,120,1
benjamingr,"Maybe @petkaantonov @phpnode or @spion would like to weigh in?",FALSE,TRUE,10,119,293,1,FALSE,TRUE,FALSE,TRUE,0,120,2
addaleax,"@not-an-aardvark Updated with that extra argument handling removed. You make a good point about minor vs major updates, and the util.promisify.custom logic is there to allow users to address edge cases like these themselves anyway.",FALSE,TRUE,35,120,294,0,TRUE,TRUE,FALSE,TRUE,0,121,1
addaleax,"Rebased and squashed, fresh CI: https://ci.nodejs.org/job/node-test-commit/9461/",FALSE,TRUE,6,121,295,0,TRUE,TRUE,FALSE,TRUE,0,122,1
addaleax,"@nodejs/ctc: As @jasnell pointed out, it would make sense to include this in the RCs for Node 8 if it should land, so we may need to vote on this.",FALSE,TRUE,30,121,296,1,TRUE,TRUE,TRUE,TRUE,0,122,2
jasnell,"@misterdjules ... how firm is your -1 on this. For the sake of the other @nodejs/ctc members who may not have the time to read the entire thread, can you summarize your position on this (or link to one of your comments that you feel gives the best summary of your position).",FALSE,TRUE,52,122,297,0,FALSE,TRUE,FALSE,TRUE,0,123,1
misterdjules,"@jasnell A summary of my current position could be (my apologies for the wall of text):",FALSE,TRUE,16,123,298,0,FALSE,TRUE,FALSE,TRUE,0,124,1
misterdjules,"With the changes in this PR, it seems that the node platform commits to supporting a promises based API*. However, this API would break the use case of post-mortem debugging users who rely on errors thrown making node processes abort synchronously and dump core, unless they're explicitly caught.",FALSE,TRUE,48,123,300,2,FALSE,TRUE,FALSE,TRUE,0,124,2
misterdjules,"Some of us have tried to explore solutions to this problem that do not require changes to the design of promises, and so far I don't think anyone succeeded.",FALSE,TRUE,29,123,301,3,FALSE,TRUE,FALSE,TRUE,0,124,3
misterdjules,"But it seems there's more exploration we can do. I think a good example of a similar situation is the changes that were submitted to have domain better support promises.",FALSE,TRUE,30,123,302,4,FALSE,TRUE,FALSE,TRUE,0,124,4
misterdjules,"When that work started, it wasn't clear for everyone why this was worth doing, maybe because of the perception that nobody uses domains since they've been deprecated. But users don't necessarily have the choice, the ability, or the resources to update their code to adapt to an ever changing platform.",FALSE,TRUE,50,123,303,5,FALSE,TRUE,FALSE,TRUE,0,124,5
misterdjules,"It seems at the end everyone had a better understanding of the use case, the problem and even learned a few things about how promises interact with domains. Now we have a better story to tell our users of domains, who will be able to use Promises in a way that is more compatible with them.",FALSE,TRUE,56,123,304,6,FALSE,TRUE,FALSE,TRUE,0,124,6
misterdjules,"So I would like to see something similar done with post-mortem debugging: spending more time exploring potential solutions, including those that could require a spec change (even if just to determine that a spec change is impossible), before committing to this API.",FALSE,TRUE,42,123,306,8,FALSE,TRUE,FALSE,TRUE,0,124,7
misterdjules,"The outcome could be, on one end of the spectrum, that there is no solution to provide the guarantees that post-mortem debugging users need when they run code that uses these APIs based on Promises.",FALSE,TRUE,35,123,307,9,FALSE,TRUE,FALSE,TRUE,0,124,8
misterdjules,"On the other end of the spectrum, even if that may seem really optimistic and a bit naive, we might find a solution that suits the need of all our users.",FALSE,TRUE,31,123,308,10,FALSE,TRUE,FALSE,TRUE,0,124,9
misterdjules,"At worst we'll have a better understanding of the problem, we'll be able to communicate it better, and we will have shown our users that we care about them, even if their use case is not the most popular. It seems that would make whatever decision we make much easier to support.",FALSE,TRUE,52,123,309,11,FALSE,TRUE,FALSE,TRUE,0,124,10
misterdjules,"Without doing that additional work before committing to this API, it seems we'd leave some of our users, including some of our most prominent users, with the impression that we haven't done as much research as we could have done to guarantee that the part of the platform we control works consistently for them. In my opinion that could be interpreted as a strong message that they should start to look elsewhere for a platform that aligns better with their needs.",FALSE,TRUE,81,123,310,12,FALSE,TRUE,TRUE,TRUE,0,124,11
misterdjules,"As a result I'm currently still -1 on this PR.",FALSE,TRUE,10,123,311,13,FALSE,TRUE,FALSE,TRUE,0,124,12
misterdjules,"* Some will disagree with that statement: I think exposing a function that creates other functions exposes those functions as a public, committed API. Others think that it provides a way to opt into this API, and doesn't commit to anything.",FALSE,TRUE,41,123,312,14,FALSE,TRUE,FALSE,TRUE,0,124,13
jasnell,"@misterdjules ... thank you very much. That's exactly what I was hoping for. Let me ask one more question: is there some set of actions that could be taken to switch your position to +1 on this?",FALSE,TRUE,37,124,313,0,FALSE,TRUE,FALSE,TRUE,0,125,1
Fishrock123,"Going to try to give this a full read though monday or tuesday... ðŸ¤ž",FALSE,TRUE,14,125,314,0,FALSE,FALSE,FALSE,TRUE,0,126,1
Fishrock123,"(Assigning so I remember it!)",FALSE,TRUE,5,125,315,1,FALSE,TRUE,FALSE,TRUE,0,126,2
thefourtheye,"Nit: Should we use internal/errors? We have an error defined for this.",FALSE,TRUE,12,126,316,0,FALSE,TRUE,FALSE,TRUE,0,127,1
addaleax,"@thefourtheye sure, done",FALSE,TRUE,3,127,317,0,TRUE,FALSE,FALSE,TRUE,0,128,1
ChALkeR,"@addaleax, one of the commits here (util: add util.promisify()) is saying that it fixes nodejs/CTC#12, but that issue describes two methods (under the same name, though) â€” one doing what this PR does, and one doing something similar to promisifyAll:",FALSE,FALSE,40,128,318,0,FALSE,TRUE,FALSE,TRUE,0,129,1
ChALkeR,"If this method is passed an object, the method returns an object with the same method names -each of the methods returns an awaitable value (promise) instead of taking a callback.",FALSE,FALSE,31,128,319,1,FALSE,TRUE,FALSE,TRUE,0,129,2
ChALkeR,"While I don't think that it's worth implementing that in this PR right now and delaying this, but I also don't think that this PR should close nodejs/CTC#12. /cc @benjamingr as the original issue author, though â€” perhaps I am being wrong here.",FALSE,FALSE,43,128,320,2,FALSE,TRUE,TRUE,TRUE,0,129,3
misterdjules,"is there some set of actions that could be taken to switch your position to +1 on this?",FALSE,TRUE,18,129,322,1,FALSE,FALSE,FALSE,TRUE,0,130,1
misterdjules,"The crux of the problem for me is more that I'm not convinced that we have a shared understanding of the impact of this PR.",FALSE,TRUE,25,129,323,2,FALSE,TRUE,FALSE,TRUE,0,130,2
misterdjules,"So it's not necessarily that a specific set of actions would bring me to be in favor of merging this PR, but more that it's currently not possible for me, given what data has been presented so far, to be confident that this is a needed addition to core.",FALSE,TRUE,49,129,324,3,FALSE,TRUE,FALSE,TRUE,0,130,3
misterdjules,"Leaving post-mortem debugging issues aside for a moment, it seems from nodejs/CTC#12 (comment) that the motivation for this PR is to allow a promises based API to perform better than userland alternatives.",FALSE,TRUE,32,129,325,4,FALSE,TRUE,FALSE,TRUE,0,130,4
misterdjules,"However, I don't think I've seen any benchmarks results mentioned in that issue or this PR that measure the impact of these changes compared to other solutions. How would one know whether this PR actually achieves the goal set by that issue, and whether it justifies the cost of adding this in core?",FALSE,TRUE,53,129,327,6,FALSE,TRUE,FALSE,TRUE,0,130,5
addaleax,"it seems from nodejs/CTC#12 (comment) that the motivation for this PR is to allow a promises based API to perform better than userland alternatives.",FALSE,TRUE,24,130,328,0,TRUE,TRUE,FALSE,TRUE,0,131,1
addaleax,"Fwiw, itâ€™s nice that it seems to perform good according to @benjamingrâ€™s comments, and itâ€™s nice that it allows core to provide better (and likely faster) promisified implementations of methods than userland, but for me this is more about the feature itself than about its performance.",FALSE,TRUE,46,130,329,1,TRUE,TRUE,FALSE,TRUE,0,131,2
addaleax,"@ChALkeR Lpetting @benjamingr make that call sounds good to me. I have no problem changing the Fixes: tag, or letting anybody re-open that issue if this closes it and they want to.",FALSE,TRUE,32,130,330,2,TRUE,TRUE,FALSE,TRUE,0,131,3
benjamingr,"@ChALkeR thanks for bringing it up. I'm in favor of this PR only supporting promisify that takes a function rather than an object (like @addaleax's original PR contained) since it narrows the scope of the PR while keeping the core functionality.",FALSE,TRUE,41,131,332,1,FALSE,TRUE,FALSE,TRUE,0,132,1
benjamingr,"I think we might have edge cases we're unaware of when promisifying whole objects - and I think proceeding with just the function variant, letting it sit for a while and then proceeding based on how people use it is the best path forward",FALSE,TRUE,44,131,334,3,FALSE,TRUE,FALSE,TRUE,0,132,2
jasnell,"@misterdjules ... thank you again. Ok, I think that clarifies  your position perfectly.",FALSE,TRUE,14,132,335,0,FALSE,TRUE,FALSE,TRUE,0,133,1
jasnell,"@addaleax and @misterdjules ... I'd like to propose a compromise approach that would at util.promisify() with Experimental status with an emitted process warning on first use, that would land in master but *notbe part of 8.0.0. It *could* land in an 8.x release after at least a month of sitting inmaster`. Before 8.x rolls over to LTS, the CTC would make a decision about whether to keep the API as experimental in 8.x LTS or remove it.",FALSE,TRUE,77,132,337,2,FALSE,TRUE,FALSE,TRUE,0,133,2
jasnell,"The idea here is to give us time to exercise this code in a limited way in the ecosystem. See if it does what it is supposed to do, chase down any issues that actually do exist, or determine for certain whether the issues we suspect exist actually do or are worthwhile worrying about, etc.",FALSE,TRUE,55,132,338,3,FALSE,TRUE,FALSE,TRUE,0,133,3
ljharb,"If it's experimental and thus could be removed at any time, do you think the ecosystem will be able to actually fully exercise it?",FALSE,TRUE,24,133,339,0,FALSE,FALSE,FALSE,TRUE,0,134,1
addaleax,"@jasnell I know we talked about this in person, but I still donâ€™t think thatâ€™s really a good compromise.",FALSE,TRUE,19,134,340,0,TRUE,TRUE,FALSE,TRUE,0,135,1
addaleax,"To me (and obviously to @misterdjules as well, just from a different perspective) the decision to make here is about Promise support in Node core, not this particular feature, and I donâ€™t think experimental status would change that.",FALSE,TRUE,38,134,341,1,TRUE,TRUE,FALSE,TRUE,0,135,2
addaleax,"(Also, I think the small API surface size here makes experimental status a lot less meaningful than for e.g. N-API from a technical point of view.)",FALSE,TRUE,26,134,342,2,TRUE,TRUE,FALSE,TRUE,0,135,3
addaleax,"edit: as @benjamingr words it better below, this is not about Promise support but rather about how core APIs interoperate with Promises.",FALSE,TRUE,22,134,343,3,TRUE,TRUE,FALSE,TRUE,0,135,4
benjamingr,"How would one know whether this PR actually achieves the goal set by that issue, and whether it justifies the cost of adding this in core?",FALSE,TRUE,26,135,345,1,FALSE,TRUE,FALSE,TRUE,0,136,1
benjamingr,"Good question!",FALSE,TRUE,2,135,346,2,FALSE,TRUE,FALSE,TRUE,0,136,2
benjamingr,"Quoting @littledan (working on V8):",FALSE,TRUE,5,135,347,3,FALSE,TRUE,FALSE,TRUE,0,136,3
benjamingr,"However, the benefit that built-in promisify gave was huge. On top of not allocating closures, as @addaleax 's patch already does, avoiding C++/JS transitions has been important in making Promises fast. V8 extras may be a faster way to optimize promisify than using the V8 API since it avoids a JS/C++ transition; if extras are only available to Core, that could give a good reason to put promisify in Core.",FALSE,TRUE,70,135,348,4,FALSE,TRUE,FALSE,TRUE,0,136,4
benjamingr,"I've measured this PR by changing lifter in fakesP to util.promisify which leaves the benchmark the same but uses the core method instead of probably the fastest possible variant of promisify available in userland.",FALSE,TRUE,34,135,349,5,FALSE,TRUE,FALSE,TRUE,0,136,5
benjamingr,"With util.promisify:",FALSE,TRUE,2,135,350,6,FALSE,TRUE,FALSE,TRUE,0,136,6
benjamingr,"Withoug util.promisify:",FALSE,TRUE,2,135,351,7,FALSE,TRUE,FALSE,TRUE,0,136,7
ChALkeR,"@ljharb @jasnell It being experimental means that it shouldn't land on any release branch without being hidden behind an opt-in flag. Else there would be problems with the ecosystem compatibility.",FALSE,TRUE,30,136,353,0,FALSE,TRUE,TRUE,TRUE,0,137,1
ChALkeR,"That said, the issue @misterdjules mentioned is the lack of benchmarks that prove that this is in fact useful when compared to userland implementation.",FALSE,TRUE,24,136,354,1,FALSE,TRUE,FALSE,TRUE,0,137,2
ChALkeR,"@addaleax @benjamingr Are there any benchmarks available?",FALSE,TRUE,7,136,355,2,FALSE,TRUE,FALSE,TRUE,0,137,3
ChALkeR,"Upd: it looks like I was slow here, the benchmarks are already above. ;-)",FALSE,TRUE,14,136,356,3,FALSE,TRUE,FALSE,TRUE,0,137,4
benjamingr,"@ChALkeR just added.",FALSE,TRUE,3,137,357,0,FALSE,FALSE,FALSE,TRUE,0,138,1
benjamingr,"@addaleax, I'd like to disagree that this adds support for promises to core. Support for promises was added when the global Promise was exposed, there is already code in core to deal with promise support and promises (such as running the microtasks).",FALSE,TRUE,42,137,358,1,FALSE,TRUE,FALSE,TRUE,0,138,2
benjamingr,"This PR (in my opinion) just improves the way core interops with async/await and the language for users without touching on the surface API itself or introducing any sort of promise endorsement or promise API.",FALSE,TRUE,35,137,359,2,FALSE,TRUE,FALSE,TRUE,0,138,3
Fishrock123," Support  and  Functionality  are not the same thing, fwiw.",FALSE,TRUE,9,138,360,0,FALSE,FALSE,FALSE,TRUE,0,139,1
benjamingr,"On the other hand, I'm seeing some OOM errors in the parallel benchmark @addaleax. I think it's worth investigating. In order to reproduce:",FALSE,TRUE,23,139,361,0,FALSE,TRUE,FALSE,TRUE,0,140,1
benjamingr,"clone bluebird: git clone https://github.com/petkaantonov/bluebird",FALSE,TRUE,5,139,362,1,FALSE,FALSE,FALSE,TRUE,0,140,2
benjamingr,"cd bluebird",FALSE,TRUE,2,139,363,2,FALSE,FALSE,FALSE,TRUE,0,140,3
benjamingr,"npm i",FALSE,TRUE,2,139,364,3,FALSE,FALSE,FALSE,TRUE,0,140,4
benjamingr,"./bench parallel NODE_BINARY_PATH_FOR_PR",FALSE,TRUE,3,139,365,4,FALSE,TRUE,FALSE,TRUE,0,140,5
benjamingr,"Next to use util.promisify, go to ./benchmark/lib/fakesP and change:",FALSE,TRUE,9,139,366,5,FALSE,TRUE,FALSE,TRUE,0,140,6
jasnell,"@addaleax ... ok, yeah I figured as much but wanted to at least try again (it never hurts to ask).",FALSE,TRUE,20,140,368,0,FALSE,TRUE,FALSE,TRUE,0,141,1
jasnell,"@addalex and @misterdjules ... how do you want to proceed on this? Given the inability to come to a consensus, there are two options: we either (1) Don't do anything for now and or (2) Call a CTC vote. (The question is largely for @addaleax ...)",FALSE,TRUE,46,140,369,1,FALSE,TRUE,FALSE,TRUE,0,141,2
benjamingr,"@jasnell I think we're still at the point we're making progress. @misterdjules has made reasonable requests (to see benchmarks and performance rationale, which I just added).",FALSE,TRUE,26,141,370,0,FALSE,TRUE,FALSE,TRUE,0,142,1
benjamingr,"Since consensus has not yet been reached, I think we should at least continue to pursue it for a little while longer until everything but the post-mortem concerns (mostly because this doesn't expand the API IMO) are addressed.",FALSE,TRUE,38,141,371,1,FALSE,TRUE,TRUE,TRUE,0,142,2
benjamingr,"I think a CTC vote is a good idea if/when we stop making progress. I think a few more days would for community discussion would be nice here given we've been waiting for this for over a year anyway.",FALSE,TRUE,39,141,372,2,FALSE,TRUE,FALSE,TRUE,0,142,3
jasnell,"Ok. I'm good with that. I'm just looking at the timeline for 8.0.0. If this is going to make it, it would ideally land within the next week. Otherwise it'll get pushed out.",FALSE,TRUE,33,142,373,0,FALSE,TRUE,FALSE,TRUE,0,143,1
addaleax,"@benjamingr sorry, I couldnâ€™t reproduce any trouble that wayâ€¦",FALSE,TRUE,9,143,374,0,TRUE,TRUE,FALSE,TRUE,0,144,1
addaleax,"@jasnell Yeah, a CTC vote this week was what I had in mind, thatâ€™s why Iâ€™ve put it on the agenda.",FALSE,TRUE,21,143,375,1,TRUE,TRUE,FALSE,TRUE,0,144,2
MylesBorins,"@ljharb @jasnell It being experimental means that it shouldn't land on any release branch without being hidden behind an opt-in flag. Else there would be problems with the ecosystem compatibility.",FALSE,FALSE,30,144,376,0,FALSE,TRUE,TRUE,TRUE,0,145,1
MylesBorins,"@ChALkeR fwiw that is not how we handled the experimental URL api, or any other experimental API in the past afaik",FALSE,FALSE,21,144,377,1,FALSE,TRUE,FALSE,TRUE,0,145,2
addaleax,"@MylesBorins just icymi, thereâ€™s a bit of discussion around that happening in #12723 :)",FALSE,TRUE,14,145,378,0,TRUE,FALSE,FALSE,TRUE,0,146,1
benjamingr,"Hey, given no discussion in the last 3 days - can we bring this to a CTC vote?",FALSE,TRUE,18,146,379,0,FALSE,TRUE,FALSE,TRUE,0,147,1
addaleax,"I agree. @nodejs/ctc Iâ€™m calling for a vote on whether to accept this PR (barring minor adjustments for review comments, if there are any). Iâ€™ve pre-filled some of the entries based on approving this PR or voicing formal objection (See #12442 (comment) for @misterdjulesâ€™ good explanation of why he is opposed).",FALSE,TRUE,51,147,380,0,TRUE,TRUE,FALSE,TRUE,0,148,1
addaleax,"In favour: @addaleax @jasnell @evanlucas @targos @MylesBorins @ChALkeR @thefourtheye @ofrobots @fhinkelAgainst: @misterdjulesAbstain: @mscdex @Trott @cjihrig @indutnyNot voted yet: @bnoordhuis @Fishrock123 @mhdawson @rvagg @shigeki @trevnorris",FALSE,TRUE,24,147,381,1,TRUE,TRUE,FALSE,TRUE,0,148,2
addaleax,"(please feel free to edit this comment for the vote, and conversely please only edit this comment if youâ€™re a CTC member)",FALSE,TRUE,22,147,382,2,TRUE,TRUE,FALSE,TRUE,0,148,3
benjamingr,"Adding some context about the work here and concerns raised and handled for the CTC:",FALSE,TRUE,15,148,383,0,FALSE,TRUE,FALSE,TRUE,0,149,1
benjamingr,"Some collaborators were concerned about cancellation in the API, it was removed.",FALSE,TRUE,12,148,384,1,FALSE,TRUE,FALSE,TRUE,0,149,2
benjamingr,"Some collaborators were concerned about API examples, these were added.",FALSE,TRUE,10,148,385,2,FALSE,TRUE,FALSE,TRUE,0,149,3
benjamingr,"Some collaborators were concerned about the object variant and behavior, it was decided to start with the function one only and figure out if a bigger API is needed later.",FALSE,TRUE,30,148,386,3,FALSE,TRUE,FALSE,TRUE,0,149,4
benjamingr,"Some collaborators were concerned with  why in core , V8 engineers posted detailed responses on why this needs to be in core, and the benchmark suite the most popular promise library (and V8 itself) uses demonstrates this PR gives a significant performance boost over userland implementation.",FALSE,TRUE,45,148,387,4,FALSE,TRUE,FALSE,TRUE,0,149,5
benjamingr,"Some collaborators were concerned not adding full support. Use cases were provided where this support is required from the platform that remain even with a promise returning core in the future. In addition, actual support for promises in core APIs is blocked on post-mortem concerns at the moment.",FALSE,TRUE,48,148,388,5,FALSE,TRUE,FALSE,TRUE,0,149,6
benjamingr,"Some collaborators brought post-mortem concerns, these were discussed and are still debated. In my opinion this PR does not make promise support any better or worse. On the other hand @addaleax added support for domains with promises to alleviate some concerns about promises and tooling.",FALSE,TRUE,45,148,389,6,FALSE,TRUE,FALSE,TRUE,0,149,7
benjamingr,"Some collaborators brought up style nits in the PR, these were addressed.",FALSE,TRUE,12,148,390,7,FALSE,TRUE,FALSE,TRUE,0,149,8
benjamingr,"Some discussion was had about the symbol exposed.",FALSE,TRUE,8,148,391,8,FALSE,TRUE,FALSE,TRUE,0,149,9
benjamingr,"Also see nodejs/CTC#12 for the nodejs/CTC issue, as well as 19 issues in the repo over the years https://github.com/nodejs/node/search?p=2&q=promisify&type=Issues&utf8=%E2%9C%93 , the issues in the original archive repo, and https://github.com/nodejs/promises  nodejs/promises#5",FALSE,TRUE,31,148,392,9,FALSE,TRUE,FALSE,TRUE,0,149,10
ChALkeR,"@ChALkeR fwiw that is not how we handled the experimental URL api, or any other experimental API in the past afaik",FALSE,TRUE,21,149,394,1,FALSE,TRUE,FALSE,TRUE,0,150,1
ChALkeR,"That's how it's documented atm. See #11362, btw.",FALSE,TRUE,8,149,395,2,FALSE,TRUE,FALSE,TRUE,0,150,2
ChALkeR,"#12723 aims to change the documented definition of Experimental, but if this is going to be labelled as experimental and not be behind a flag, then #12723 should ideally land first (read as: this PR should have been blocked by #12723, if that was the case).",FALSE,TRUE,46,149,396,3,FALSE,TRUE,TRUE,TRUE,0,150,3
ChALkeR,"It doesn't look like this is labelled as Experimental, though, so that's not an issue here :-).",FALSE,TRUE,17,149,397,4,FALSE,TRUE,FALSE,TRUE,0,150,4
benjamingr,"@ChALkeR correct, the suggestion was redracted and @addaleax called for a CTC vote #12442 (comment)",FALSE,TRUE,15,150,398,0,FALSE,TRUE,FALSE,TRUE,0,151,1
benjamingr,"(I agree with the point about experimental though)",FALSE,TRUE,8,150,399,1,FALSE,FALSE,FALSE,TRUE,0,151,2
ChALkeR,"@benjamingr Thanks, I missed that. I recorded my vote just now. That should not be treated as a review, though =).",FALSE,TRUE,21,151,400,0,FALSE,TRUE,TRUE,TRUE,0,152,1
benjamingr,"Pinging @nodejs/ctc since we're still missing 8 votes on #12442 (comment) and some time has passed.",FALSE,TRUE,16,152,401,0,FALSE,FALSE,FALSE,TRUE,0,153,1
benjamingr,"Note at this point it is enough for one person to support or 2 to abstain to pass this.",FALSE,TRUE,19,152,402,1,FALSE,TRUE,FALSE,TRUE,0,153,2
indutny,"I abstain from the vote.",FALSE,TRUE,5,153,403,0,FALSE,FALSE,FALSE,TRUE,0,154,1
ChALkeR,"@misterdjules Could you post an update, please?",FALSE,TRUE,7,154,404,0,FALSE,TRUE,FALSE,TRUE,0,155,1
ChALkeR,"Re: post-mortem issues:",FALSE,TRUE,3,154,405,1,FALSE,TRUE,FALSE,TRUE,0,155,2
ChALkeR,"I personally don't think that this will significantly impact the usage of promises in the ecosystem â€” those are already there and already widely used. Btw, we got async/await support already (not in the core API, though). Many libraries out there are already providing Promise-based APIs.Or are your concerns related to the expectation that the next step is going to be to provide some Promise-based API support in the core?",FALSE,TRUE,70,154,406,2,FALSE,TRUE,FALSE,TRUE,0,155,3
ChALkeR,"Could you elaborate which specific usage patterns are going to be broken?",FALSE,TRUE,12,154,408,4,FALSE,TRUE,FALSE,TRUE,0,155,4
ChALkeR,"Re: other concerns:",FALSE,TRUE,3,154,409,5,FALSE,TRUE,FALSE,TRUE,0,155,5
ChALkeR,"Leaving post-mortem debugging issues aside for a moment, it seems from nodejs/CTC#12 (comment) that the motivation for this PR is to allow a promises based API to perform better than userland alternatives.",FALSE,TRUE,32,154,410,6,FALSE,TRUE,FALSE,TRUE,0,155,6
ChALkeR,"However, I don't think I've seen any benchmarks results mentioned in that issue or this PR that measure the impact of these changes compared to other solutions. How would one know whether this PR actually achieves the goal set by that issue, and whether it justifies the cost of adding this in core?",FALSE,TRUE,53,154,412,8,FALSE,TRUE,FALSE,TRUE,0,155,7
ChALkeR,"I believe that was already answered in #12442 (comment) and below and it was demonstrated that this approach performs better than the fastest known userland alternative (in bluebird, which is a quite complex one with all its evals and other magic), and that also makes it significantly better than the simple means of promisifying often done in userland outside bluebird.",FALSE,TRUE,60,154,414,10,FALSE,TRUE,FALSE,TRUE,0,155,8
ChALkeR,"On the vote side, we have 1 more in favour or 1 more abstaining vote missing in order to come to a resolution.",FALSE,TRUE,23,155,415,0,FALSE,FALSE,FALSE,TRUE,0,156,1
ChALkeR,"That said, I would rather prefer if we could resolve the concerns than resolving this with a vote, if possible.",FALSE,TRUE,20,155,416,1,FALSE,TRUE,FALSE,TRUE,0,156,2
benjamingr,"We tried resolving the concerns and addressing them for a while for several days before calling for a vote.",FALSE,TRUE,19,156,417,0,FALSE,FALSE,FALSE,TRUE,0,157,1
benjamingr,"I would also prefer a consensus resolution - it's been a while already :)",FALSE,TRUE,14,156,418,1,FALSE,TRUE,FALSE,TRUE,0,157,2
benjamingr,"I think if we wait for @Fishrock123 to show up we'll have that last +1 since he's been a supporter and reviewer of this PR as well as a great help and contributor to having promises work in Node correctly.",FALSE,TRUE,40,156,419,2,FALSE,TRUE,FALSE,TRUE,0,157,3
addaleax,"I would also prefer a consensus resolution - it's been a while already :)",FALSE,TRUE,14,157,420,0,TRUE,FALSE,FALSE,TRUE,0,158,1
addaleax,"I think that â€œwhileâ€? has been since at least the #5020 days, if weâ€™re being honest. :/ Obviously, Iâ€™d prefer a consensus-based solution, too, I just donâ€™t see that as realistic in the foreseeable future.",FALSE,TRUE,35,157,421,1,TRUE,TRUE,FALSE,TRUE,0,158,2
addaleax,"(edit: also, Iâ€™ll rebase this tomorrow, the conflicts should only be with #12726, I think)",FALSE,TRUE,15,157,422,2,TRUE,TRUE,TRUE,TRUE,0,158,3
fhinkel,"Voting in favor",FALSE,TRUE,3,158,423,0,FALSE,FALSE,FALSE,TRUE,0,159,1
benjamingr,"@addaleax we can land this! ðŸŽ‰ ðŸŽ‰ ðŸŽ‰ ðŸŽ‰ ðŸŽ‰ ðŸŽ‰",FALSE,TRUE,11,159,424,0,FALSE,FALSE,FALSE,TRUE,0,160,1
addaleax,"Landed in f72376d...faf6654",FALSE,TRUE,3,160,425,0,TRUE,FALSE,FALSE,TRUE,0,161,1
addaleax,"Thanks everyone for the reviews and support!",FALSE,TRUE,7,160,426,1,TRUE,TRUE,FALSE,TRUE,0,161,2
benjamingr,"@addaleax going to give a small talk about this journey on Thursday, starting in nodejs/node-v0.x-archive#7642",FALSE,TRUE,15,161,427,0,FALSE,TRUE,FALSE,TRUE,0,162,1
benjamingr,"Thanks a ton for taking up the glove and working together on the conceptual side, while undertaking the vast majority of the technical burden. Props for the execution and delivery, and thank you :)",FALSE,TRUE,34,161,428,1,FALSE,TRUE,FALSE,TRUE,0,162,2
thefourtheye,"@MadaraUchiha You were right! This PR is @benjamingr's birthday present ðŸ˜‰",FALSE,TRUE,11,162,429,0,FALSE,TRUE,FALSE,TRUE,0,163,1
